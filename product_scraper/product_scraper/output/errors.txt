2019-04-28 11:32:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-fleece-hoodie?ID=6606501&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:32:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-superlite-prime-cap?ID=6978349&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:32:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-plaid-madras-suit-separates?ID=8167525&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:32:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-suiting-driver?ID=8796904&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:32:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-jacquard-camo-pajama-shorts?ID=8269019&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:32:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-windowpane-ultraflex-classic-fit-suit-separates?ID=8010685&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-signature-pajama-shirt?ID=785434&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:33:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-flex-stretch-black-tuxedo-separates?ID=5917901&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-x-fit-infinite-stretch-black-tuxedo-suit-separates?ID=6095179&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-sportswear-honeycomb-beanie?ID=6369820&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:33:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-reaction-trucker-hat?ID=7454609&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:33:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-infinite-slim-fit-suit-separates?ID=5519193&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-ua-pro-trucker-hat?ID=6666364&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:33:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-running-challenger-collection?ID=8029331&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-reaction-mens-techni-cole-slim-fit-flex-collar-three-way-stretch-performance-solid-dress-shirt?ID=8152135&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:33:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mens-long-sleeve-colorblocked-t-shirt?ID=8037685&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:33:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-superlite-climacool-mesh-visor?ID=5152637&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:33:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-all-over-polo-player-robe?ID=1237679&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:33:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-tartan-baseball-cap?ID=7000919&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:33:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-jeans-mens-straight-fit-jeans?ID=7106007&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:33:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hugo-mens-identity-logo-t-shirt?ID=8287688&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:33:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-signature-pajama-pants?ID=785435&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:33:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-adaptive-mens-camden-t-shirt-with-velcro-closure-at-shoulders?ID=7814524&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:33:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-crew-neck-t-shirt?ID=8174195&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:33:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-sharkskin-wool-suit-separates?ID=8046272&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-mens-neocroc-backpack?ID=8773929&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:33:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/jockey-mens-staycool-collection?ID=6791702&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-classic-fit-airsoft-stretch-brown-cream-windowpane-suit-separates?ID=8395369&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-recovery-pajama-henley-shirt?ID=5780654&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:33:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-navy-plaid-ultraflex-suit-separates?ID=627344&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-nsw-camo-collection?ID=8422222&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-heathered-knit-watchcap?ID=7961761&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:33:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-black-suits-hat?ID=863454&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:33:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-cotton-woven-plaid-pajama-shorts?ID=9062304&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:33:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-blue-sail-reversible-logo-graphic-bucket-hat-created-for-macys?ID=8456176&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:33:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-bahama-mens-moorea-marlins-print-hawaiian-shirt?ID=7105164&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:33:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-modern-fit-stretch-midnight-blue-stripe-suit-separates?ID=8781648&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-slim-fit-suit-jacket?ID=5891604&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:33:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-anchor-print-pajama-shorts?ID=8176083&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:33:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-white-linen-suit-separates?ID=8037127&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-x-fit-slim-fit-light-blue-sharkskin-suit-separates?ID=8324337&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-training-freelift-collection?ID=8761874&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-cotton-6-pairs-socks-collection?ID=1509480&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-bahama-mens-naples-tahitian-etch-hawaiian-print-6-swim-trunks?ID=7105184&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:33:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-terry-shorts?ID=8948850&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:33:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-fleece-shorts?ID=7014129&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:33:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-classic-fit-tuxedo-separates?ID=835190&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-logo-hat?ID=6828599&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:33:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-burgundy-gray-wool-tartan-plaid-vest?ID=6308790&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:33:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-sleepwear-soho-modern-plaid-robe?ID=180156&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:33:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-club-fleece-collection?ID=8024321&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:33:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-estate-tonal-logo-hat?ID=6978337&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:34:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/boss-mens-mesh-logo-cap?ID=6575779&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:34:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-adaptive-mens-color-block-sweater-with-hoop-loop-fastener-at-shoulder?ID=7799724&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:34:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-corduroy-5-pocket-straight-fit-pants?ID=6627492&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:34:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-solid-extra-fine-merino-v-neck-sweater?ID=6673102&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:34:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-burgundy-black-plaid-dress-pants?ID=6198637&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:34:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-ultraflex-classic-fit-suit-separates?ID=7828635&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:34:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-sportswear-fleece-cuff-beanie?ID=6369821&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:34:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-cotton-logo-pajama-shorts?ID=4463011&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:34:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/boss-mens-slim-fit-contrast-cotton-shirt?ID=7246235&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:34:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-sportswear-futura-twill-hat?ID=4920040&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:34:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-baseline-performance-cap?ID=5168858&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:34:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-dri-fit-stretch-performance-cutback-hat?ID=6291654&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:34:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-coolswitch-golf-cap?ID=6737003&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:34:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/closeout-calvin-klein-modern-fit-suit-separates?ID=2593866&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:34:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-twist-2.0-cap?ID=4886873&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:34:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-p-wing-active-fit-graphic-t-shirt?ID=6994055&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:34:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-recovery-pajama-jogger-pants?ID=5780656&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:34:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-fleece-separates-created-for-macys?ID=2722873&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:34:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mens-slim-fit-tapered-blackout-jeans?ID=7601799&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:34:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-navy-linen-suit-separates?ID=8040034&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:34:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-navy-brown-plaid-wool-matching-jacket-vest?ID=7241706&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:34:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-thflex-stretch-black-pinstripe-suit-separates?ID=6750739&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:34:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-windrunner-colorblocked-jacket-fleece-jogger-pants?ID=4618737&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:34:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-athletic-stretch-2-pack-boxer-brief?ID=4913147&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:34:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-great-outdoors-classic-fit-plaid-shirt?ID=6617629&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:34:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-mens-knit-pocket-t-shirt?ID=8286167&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:34:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hugo-mens-logo-joggers?ID=8287686&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:34:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-th-flex-stretch-suit-separates?ID=5904127&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:34:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mens-mixed-media-plaid-bomber-jacket?ID=7214425&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:34:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-portfolio-slim-fit-stretch-black-solid-suit-separates?ID=8259243&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:34:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-herringbone-jacquard-beanie?ID=7961765&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:34:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-big-tall-mens-pajama-pants?ID=7367747&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:34:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-basketball-therma-collection?ID=8029279&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:34:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-cotton-twill-driver?ID=8796901&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:34:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-tan-cotton-suit-separates?ID=8047036&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:34:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-engineered-stripe-sweater-knit-henley?ID=6673086&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:34:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-slim-fit-dress-pants?ID=5891602&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:34:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-baseline-long-line-tee?ID=7079158&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:34:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-waffle-knit-thermal-with-flag-logo?ID=6593592&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:34:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/armani-exchange-mens-logo-graphic-hat?ID=8422947&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:34:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-edale-grid-silk-tie?ID=6829168&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:34:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-tiro-metallic-soccer-pants?ID=4872337&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-ardin-bucket-hat?ID=8176478&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-slim-fit-gray-blue-plaid-suit-separates?ID=6609790&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:35:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-herringbone-woven-shawl-collar-robe?ID=365928&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:35:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-bahama-mens-flip-side-reversible-classic-pima-cotton-sweater?ID=5080070&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-mens-lve-embroidered-logo-cap?ID=8279463&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-flag-chambray-baseball-cap?ID=7001226&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-slim-fit-paisley-shirt-created-for-macys?ID=7014627&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-supreme-ultra-soft-pima-jerseycomfort-crew-neck-t-shirt?ID=1710369&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:35:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-braided-straw-fedora?ID=8796897&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-slim-fit-stretch-blue-charcoal-birdseye-suit-separates?ID=6664059&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:35:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-cotton-woven-plaid-pajama-shorts?ID=9229038&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:35:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-jeans-mens-logo-sweater?ID=6814977&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-statement-1981-mens-zip-hoodie?ID=8175924&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:35:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-originals-mens-seersucker-logo-hat?ID=6828611&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-printed-baseball-cap?ID=6593210&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-logo-hat?ID=6978344&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-jeans-mens-slim-fit-jeans?ID=6545501&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-windowpane-ultraflex-classic-fit-suit-separates?ID=8010869&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:35:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-logo-print-t-shirt?ID=7105992&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-gunwhale-colorblocked-hooded-yacht-jacket-created-for-macys?ID=7952709&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-tricot-hookup?ID=8423516&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:35:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-adaptive-mens-bryant-polo-shirt-with-magnetic-buttons?ID=7800410&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-bahama-mens-baja-aloha-surf-tropical-print-9-board-shorts?ID=7105187&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-classic-fit-airsoft-stretch-light-blue-windowpane-suit-separates?ID=8322452&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:35:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-estate-hat?ID=6978338&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-aerobill-colorblocked-hat?ID=6724633&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-harwich-plaid-100-cotton-long-sleeved-pajama-top?ID=803681&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:35:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-pajamas-soho-pants?ID=180069&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:35:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-twill-wool-suit-separates?ID=8031569&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:35:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-printed-woven-cotton-pajama-pants?ID=8176088&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:35:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-flag-chino-cotton-baseball-cap?ID=6115237&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-climalite-stretch-rucker-hat?ID=4836093&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-chambray-sports-cap?ID=4364676&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-waffle-knit-thermal-with-p-logo?ID=6697494&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:35:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-textured-patch-snapback-hat?ID=7454032&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-p-wing-collection?ID=8342672&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:35:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-th-flex-stretch-light-blue-plaid-suit-vest?ID=6368577&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-green-navy-velvet-sport-coat?ID=6298143&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-sport-id-11-woven-shorts?ID=5779676&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-windowpane-plaid-cotton-pajama-jam?ID=4455094&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:35:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-cotton-chino-baseball-cap?ID=6127071&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-astoria-thermal-knit-logo-graphic-hooded-henley-created-for-macys?ID=7122610&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-classic-regular-fit-easy-care-striped-dress-shirt?ID=5996483&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-blue-sharkskin-wool-suit-separates?ID=8046543&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:35:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-pony-cap?ID=5629034&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-pajamas-soho-plaid-top?ID=180068&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:35:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-truck-stop-ribbed-beanie?ID=5892489&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:35:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-waffle-knit-thermal-collection?ID=6931896&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:35:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-court-dry-7-tennis-shorts?ID=4916770&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:35:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-signature-light-weight-j-class-logo-woven-robe?ID=785433&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:36:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-micro-french-terry-pajama-shorts?ID=8269018&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:36:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-wordmark-beanie?ID=4662526&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-aerobill-classic-training-hat?ID=6724788&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-contrast-pocket-t-shirt?ID=7080456&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:36:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-sportswear-camo-collection?ID=8030939&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:36:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/boss-mens-water-repellent-cap?ID=6470612&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-embroidered-t-shirt?ID=5697190&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:36:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-liquid-touch-collection?ID=8915204&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:36:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-bradenton-colorblocked-logo-cap?ID=8176481&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-braided-straw-porkpie?ID=8796896&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-stretch-fit-rucker-cap?ID=6978342&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mens-keith-page-track-jacket-jogger-pants?ID=7454611&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:36:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-colorblocked-morris-polo-created-for-macys?ID=7996355&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:36:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-block-logo-hat-created-for-macys?ID=6653338&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-houndstooth-patchwork-shirt?ID=7109518&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:36:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-faux-suede-matching-jacket-vest?ID=7245521&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:36:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-victory-bucket-hat?ID=6947570&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-active-fit-performance-p-wing-t-shirt?ID=6994038&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:36:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-slim-fit-logo-t-shirt?ID=6699177&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:36:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-slim-fit-comfort-stretch-bright-blue-solid-suit?ID=6332993&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:36:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-plaid-flannel-pajama-pants?ID=6571678&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:36:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-sage-linen-suit-separates?ID=8038512&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:36:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-regular-fit-yarn-dyed-plaid-linen-shirt?ID=7003401&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:36:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-woven-plaid-pajama-pants?ID=1992191&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:36:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-regular-fit-stretch-blue-brown-plaid-wool-matching-jacket-vest?ID=7241754&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:36:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-white-tan-linen-ultraflex-classic-fit-short-suit-separates?ID=8177987&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:36:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-flat-brim-cap?ID=5010566&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-threadborne-seamless-t-shirt?ID=9310991&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:36:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/boss-mens-adjustable-striped-cap?ID=7786886&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-colorblocked-p-wing-cap?ID=6988937&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-th-flex-stretch-navy-pinstripe-suit-separates?ID=6611384&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:36:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-buffalo-plaid-short-sleeve-cotton-pajama-shirt?ID=5712381&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:36:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-international-corp-cap?ID=7122750&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-corduroy-logo-hat?ID=6642590&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-sportswear-aerobill-camo-cap?ID=6699829&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-big-tall-linen-blend-suit-separates?ID=2787562&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:36:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-roger-federer-tennis-collection?ID=8029409&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:36:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-p-wing-cap?ID=6994032&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:36:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-tech-fleece-half-snap-pullover?ID=6666245&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:36:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-ultra-soft-modal-pajama-pants?ID=8102636&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:37:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-supreme-comfort-pajama-t-shirt?ID=8174209&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:37:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-supreme-comfort-pajama-pants?ID=8174213&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:37:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-ultimate-logo-cap?ID=7449655&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:37:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-plaid-pajama-pants?ID=8174223&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:37:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-red-tan-linen-suit-separates?ID=8323880&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:37:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-relaxed-three-stripe-cap?ID=7449659&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:37:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-plaid-pajama-shirt?ID=8174219&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:37:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-rafael-nadal-tennis-colletion?ID=8029507&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:37:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/armani-exchange-mens-logo-graphic-hat?ID=8422958&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:37:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-abner-shirt-slim-fit-pants-created-for-macys?ID=8421005&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:37:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-logo-graphic-hat?ID=8204770&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:37:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-mens-knit-pajama-shorts?ID=8286166&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:37:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-tastigo-climalite-soccer-shorts?ID=6712919&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:37:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-great-outdoors-classic-fit-t-shirt?ID=6606427&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:37:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-navy-plaid-suit-separates?ID=8325179&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:37:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-big-tall-classic-regular-fit-non-iron-stretch-dress-shirt?ID=6324644&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:37:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-flat-front-colorblocked-sateen-shorts?ID=8083428&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:37:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-skinny-fit-infinite-stretch-suit-separates?ID=6154983&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:37:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-embroidered-logo-hat?ID=6091633&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:37:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-chambray-suit-separates?ID=8054928&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:37:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-pink-linen-suit-separates?ID=8039304&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:37:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-big-tall-textured-pinstriped-vest-pants?ID=2069113&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:37:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-training-pro-collection?ID=8024208&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:37:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-relaxed-logo-hat?ID=6828598&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:37:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-shadow-belt?ID=5005026&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:37:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-seersucker-camo-cap?ID=7000918&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:37:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-ribbed-beanie?ID=7961760&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:38:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-waffle-knit-thermal?ID=6593607&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:38:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-great-outdoors-classic-fit-twill-shirt?ID=6604877&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:38:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-waffle-knit-sleep-shirt?ID=6397763&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:38:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-classic-fit-double-faced-cotton-shirt?ID=7248297&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:38:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-training-freelift-spray-hookup?ID=8761857&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:38:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-training-utility-collection?ID=8024106&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:38:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-beacon-print-waffle-knit-thermal?ID=7022083&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:38:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-x-mens-extra-slim-fit-pleated-formal-white-french-cuff-tuxedo-dress-shirt-pre-tied-solid-bow-tie-set?ID=6642325&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-mens-grey-smoke-skinny-jeans?ID=6781964&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-printed-cotton-pajama-shorts?ID=8176084&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:38:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-recon-lined-pom-pom-beanie?ID=6210249&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:38:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-sportswear-camo-print-hat?ID=6702086&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:38:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-superlite-climalite-cap?ID=5098605&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:38:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-knit-pajama-shorts?ID=2404374&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:38:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-originals-camo-logo-visor?ID=6828612&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:38:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-plaid-flannel-pajama-pants?ID=1722327&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:38:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-2-pack-climacool-performance-boxer-briefs?ID=2744654&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:38:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-tech-v-neck-t-shirt?ID=6655127&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:38:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-bridge-mock-collar-sweater-created-for-macys?ID=6989818&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:38:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hugo-mens-cotton-t-shirt?ID=8287714&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:38:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-light-blue-bold-plaid-suit-separates?ID=8322894&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:38:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-tan-linen-suit-separates?ID=8040307&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:38:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-tropical-fish-printed-quick-dry-8-swim-trunks?ID=6668322&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:38:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-tiro-19-collection?ID=8387822&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:38:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-adaptive-mens-bayport-windbreaker-with-magnetic-zipper?ID=7800420&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:38:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-big-tall-quarter-zip-striped-navtech-sweater?ID=6865369&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:38:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/boss-mens-regular-classic-fit-tropical-print-cotton-shirt?ID=6559129&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:38:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-amos-performance-stretch-check-shirt?ID=8010615&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:38:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-super-soft-cotton-comfort-pajama-pants?ID=4460635&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:38:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-solid-ultraflex-classic-fit-suit-separates?ID=627350&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:38:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-adaptive-mens-rugby-polo-shirt-with-magnetic-buttons?ID=7799731&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:38:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-paint-splatter-crested-cap?ID=6994635&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:38:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/armani-exchange-mens-logo-graphic-hat?ID=8302020&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:38:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-classic-regular-fit-blue-navy-plaid-wool-sport-coat?ID=6310449&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:38:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-cotton-no-show-liner-socks-3-pack?ID=1716515&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:39:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-bear-mens-ultra-soft-waffle-knit-thermal-shirt?ID=5018143&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:39:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mens-leaf-print-shirt?ID=7673054&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:39:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-logo-baseball?ID=8796900&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:39:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-classic-regular-fit-non-iron-stretch-pink-check-dress-shirt?ID=6636117&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:39:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-pro-collection?ID=6350078&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:39:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-sail-bait-hat?ID=7454033&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:39:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-bahama-mens-kayo-blossoms-tropical-print-hawaiian-shirt?ID=7105189&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:39:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-slim-fit-stretch-solid-suit-separates?ID=8279870&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:39:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hugo-mens-stretch-tank-top?ID=8287708&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:39:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-jeans-mens-athletic-tapered-fit-jeans-collection?ID=9064056&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:39:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-plaid-madras-suit-separates?ID=8167563&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:39:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-logo-baseball-cap?ID=560692&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:39:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-logo-cap?ID=6828617&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:39:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-all-over-polo-player-pajama-shirt?ID=1237677&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:39:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-jeans-mens-monogram-logo-hoodie-created-for-macys?ID=8329428&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:39:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-pajama-t-shirt?ID=8176085&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:39:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-wynwood-bomber-jacket-created-for-macys?ID=6642243&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:39:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-cove-hat?ID=6291651&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:39:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-flagship-zip-front-jacket-created-for-macys?ID=7996375&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:39:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-bahama-mens-your-cart-is-full-graphic-t-shirt?ID=7105218&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:39:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-th-flex-stretch-blue-gray-twill-vested-suit-separates?ID=6606202&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:39:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-tennis-parley-collection?ID=8425112&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:39:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-fashion-logo-t-shirt?ID=6664309&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:39:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-reaction-logo-trucker-hat?ID=6947571&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:39:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-x-slim-fit-stretch-charcoal-mini-grid-suit-separates?ID=8781024&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:39:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-black-solid-big-tall-suit-classic-fit-separates?ID=635149&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:39:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/get-the-look-calvin-klein-jeans-big-tall-straight-fit-jeans-nautica-polo-polo-ralph-lauren-vaughn-chambray-herringbone-sneakers?ID=6090522&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:39:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-logo-jogger-pants-created-for-macys?ID=7951672&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:39:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-jeans-mens-slim-fit-jeans-collection?ID=9063998&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:39:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-front-zip-weekend-jacket?ID=6930409&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:39:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-wallet-burnished-passcase?ID=756909&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:39:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-bahama-mens-sand-stripe-shirt?ID=7105198&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:39:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-windowpane-plaid-cotton-robe?ID=5536742&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:40:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-logo-trucker-hat?ID=6828607&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-slim-fit-stretch-blue-neat-suit-separates?ID=6666093&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-derby-racehorse-to-tie-silk-bow-tie?ID=6119859&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:40:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-core-classic-sport-cap?ID=391810&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-one-only-texture-flexfit-logo-hat?ID=1842831&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-performance-cap?ID=8908692&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-thflex-stretch-solid-white-suit-separates?ID=8323617&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-jeans-skinny-fit-jeans-collection?ID=9064377&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-supreme-comfort-sleep-shorts?ID=8174215&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:40:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-mens-printed-jogger-pajamas?ID=8286141&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:40:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-black-white-windowpane-vested-suit-separates?ID=6688893&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hugo-mens-graphic-logo-hat?ID=7935123&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-logo-cap?ID=6666749&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-the-great-outdoors-collection?ID=7884024&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-contrast-tipped-polo?ID=6642450&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:40:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-jeans-mens-straight-fit-jeans-collection?ID=9063591&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/fila-mens-aiden-logo-t-shirt?ID=6920646&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:40:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-one-only-dri-fit-hat?ID=5707425&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-graffiti-logo-t-shirt?ID=7109556&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:40:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-linen-stripe-slim-tie?ID=6872837&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:40:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-classic-fit-airsoft-stretch-dark-blue-mini-herringbone-suit-separates?ID=8448196&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-wallet-pebbled-bifold-wallet?ID=756904&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:40:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-steel-big-tall-slim-fit-non-iron-performance-stretch-unsolid-solid-dress-shirt?ID=6235269&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:40:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-black-wool-suit-separates?ID=8031169&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-originals-mens-adicolor-beckenbauer-colletion?ID=8024077&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-gray-plaid-wool-matching-jacket-vest?ID=7241518&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-big-tall-rival-fleece-hookup?ID=7828964&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-classic-fit-t-shirt?ID=5607627&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:40:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-linen-suit-separates?ID=8386262&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-freedom-2.0-logo-cap?ID=4886868&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-wool-suit-separates?ID=8046734&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/fila-mens-colorblocked-wind-jacket-pants?ID=7651760&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-alphaskin-climacool-compression-shorts?ID=4896358&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:40:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-running-own-the-run-collection?ID=8425196&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-light-blue-tic-suit-separates?ID=8449305&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-logo-pants?ID=6498532&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:40:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-big-tall-suit-separates?ID=1777874&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-burgundy-gray-tartan-plaid-wool-sport-coat?ID=6308807&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:40:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-blitzing-3.0-cap?ID=4886790&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-supreme-comfort-pajama-t-shirt?ID=8174206&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:40:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-logo-hat?ID=6828602&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-slim-fit-sleep-pants?ID=8174199&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:40:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-cotton-twill-pe-baseball?ID=8796898&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-4-in-1-reversible-beanie?ID=5892491&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-waffle-knit-henley-thermal?ID=6697507&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:40:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-camouflage-baseball-cap?ID=6593207&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-distressed-embossed-logo-t-shirt?ID=7166613&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:40:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-classic-fit-solid-ultraflex-suit-separates?ID=7111421&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-navtech-waterproof-rainbreaker-baseball-cap?ID=6670771&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:40:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-sportive-track-jacket-pants?ID=7806048&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:40:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-fcst-basketball-hookup?ID=8760425&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:41:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-statement-1981-mens-colorblocked-logo-hoodie?ID=8175926&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:41:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-holiday-gifts-accessories?ID=1275681&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:41:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-cotton-jogger-pants?ID=7367771&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:41:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-striped-rugby-shirt?ID=6642448&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:41:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-essential-tricot-track-jacket-pants?ID=5691443&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:41:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-contrast-logo-stripe-sweatshirt?ID=6728865&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:41:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-black-suit-separates?ID=7827424&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:41:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-big-tall-printed-9-swim-trunks?ID=5617663&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:41:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-heathered-suiting-basebal?ID=8796899&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/boss-mens-double-twill-logo-cap?ID=7786887&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-daytona-logo-cap?ID=8176480&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-mens-large-croc-gabardine-cap?ID=781428&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-custom-fit-stretch-signature-stripe-chinos-created-for-macys?ID=7950507&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:41:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-custom-slim-fit-long-sleeve-polo?ID=6589584&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:41:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-classic-fit-airsoft-stretch-solid-suit-separates?ID=9062534&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:41:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/boss-mens-short-visor-cap?ID=7786906&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-colorblocked-sweater?ID=7375868&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:41:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-originals-relaxed-treifoil-hat?ID=6789659&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-x-keith-haring-mens-graphic-pique-cap?ID=8411772&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-camo-long-sleeve-t-shirt?ID=6712484&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:41:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-seersucker-baseball-cap?ID=7000917&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-solid-linen-suit-separates?ID=6229013&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:41:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-reversible-crested-polo-bear-bucket-hat?ID=7039587&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-x-mens-extra-slim-fit-formal-white-french-cuff-tuxedo-dress-shirt-pre-tied-solid-bow-tie-set?ID=6642326&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:41:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-x-fit-solid-slim-fit-suit-separates?ID=2324416&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:41:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-polo-player-pajama-pants?ID=180067&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:41:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-suiting-driver?ID=8796894&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-printed-cotton-pajama-pants?ID=8176087&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:41:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-tech-essentials-collection?ID=8024437&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:41:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-signature-visor?ID=8176479&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-alphaskin-climacool-cropped-compression-tights?ID=4896355&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:41:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-greenwich-striped-low-rise-briefs?ID=8269004&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:41:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-training-collection?ID=7648955&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:41:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-sleepwear-100-cotton-harwich-plaid-woven-robe?ID=803679&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:41:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-mens-denim-skinny-jeans?ID=6781951&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:41:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-brushed-pajama-pants?ID=6620368&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:41:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-signature-pajama-shorts?ID=785436&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:41:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-mk1-camo-hookup?ID=8023478&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:41:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-mens-knit-pajama-pants?ID=8286165&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:41:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-sportswear-aerobill-hat?ID=8505503&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-blue-sail-baseball-cap-created-for-macys?ID=7787443&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-solid-linen-dress-pants?ID=9185464&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:41:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-9-shorts-created-for-macys?ID=9018558&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:41:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-tennis-collection?ID=8029341&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:41:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-logo-hat?ID=4888639&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-p-wing-active-fit-performance-t-shirt?ID=5186550&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:41:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-shawl-collar-robe?ID=5712371&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:41:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-superlite-prime-cap?ID=7449658&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:41:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-light-gray-stepweave-vested-suit-separates?ID=7958424&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:41:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-slim-fit-chambray-suit-separates-dot-print-shirt?ID=8298024&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:41:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-sport-id-wind-snap-collection?ID=8424518&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-lloyd-zip-front-graphic-sweatshirt-created-for-macys?ID=7996367&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-camo-collection?ID=8425288&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-classic-fit-fleece-zip-up-vest?ID=6935535&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-collection-for-novak-djokovic-mens-signature-ultra-dry-cap?ID=4626150&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:42:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-expandable-waist-pack?ID=6822349&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-brick-blue-windowpane-suit-separates?ID=7786620&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-relaxed-banner-logo-cap?ID=6789663&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:42:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-waffle-knit-thermal?ID=6697509&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:42:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-crew-ankle-socks?ID=2424614&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-lightweight-cotton-logo-pajama-pants?ID=4463045&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:42:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-th-flex-stretch-navy-twill-suit-separates?ID=6575798&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-black-plaid-embroidered-logo-flexfit-hat?ID=5707418&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:42:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-dri-fit-polo-shirt?ID=5692084&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mens-night-nurse-graphic-t-shirt?ID=7673047&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-slim-fit-check-dress-shirt?ID=6954291&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-slim-fit-stretch-navy-plaid-suit-pants?ID=6376606&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/boss-mens-reflective-logo-cap?ID=7786888&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:42:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-classic-fit-cotton-jersey-t-shirt?ID=8174593&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:42:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-originals-mens-washed-bucket-hat?ID=7516128&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:42:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-waffle-knit-thermal-collection?ID=7814703&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-blue-check-suit-separates?ID=6689601&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-buffalo-plaid-shawl-collar-cotton-robe?ID=5712380&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:42:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-plaid-suit-separates?ID=8010911&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/j-balvin-x-guess-collection?ID=8060208&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-light-brown-textured-suit-separates?ID=8276035&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-straw-6-panel-driver?ID=8796895&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:42:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-multi-pattern-watchcap?ID=7961770&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:42:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-mens-technical-knit-sweater?ID=6663453&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-running-pastel-collection?ID=8423274&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-double-flask-belt?ID=6822350&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-stadium-hookup?ID=8424834&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-tan-cotton-ultraflex-shorts-classic-fit-suit-separates?ID=8177934&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-tipped-polo?ID=7340774&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-classic-fit-mesh-rugby-shirt?ID=6606498&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-linen-suit-separates?ID=2665747&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-nsw-hookup?ID=8421329&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-basketball-abc-collection?ID=8424946&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-headline-3.0-storm-cap?ID=6666668&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:42:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-sportswear-classic-trucker-hat?ID=5814365&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:42:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-three-stripe-hat?ID=7449660&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:42:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-transcend-training-collection?ID=8421244&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:42:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-sleepwear-soft-cotton-kimono-velour-robe?ID=216603&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:42:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-ribbed-watchcap?ID=7961769&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:42:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-one-only-flexfit-hat?ID=761323&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:42:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-bahama-mens-moana-fronds-shirt?ID=7105193&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-big-tall-nico-custom-fit-vertical-stripe-shirt?ID=8225408&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:42:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-relaxed-trainer-hat?ID=6828603&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:42:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/boss-mens-virgin-wool-beanie-hat?ID=7006086&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:43:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-contrast-trim-bomber-jacket?ID=6211065&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-phantom-logo-graphic-hat?ID=8030549&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:43:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-originals-90s-tropical-collection?ID=8761723&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-twill-logo-cap?ID=6828609&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:43:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-armour-fleece-joggers?ID=6199101&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:43:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-portfolio-modern-fit-performance-stretch-dress-pants?ID=2102283&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:43:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-th-flex-stretch-corduroy-suit-separates?ID=6952848&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-black-white-herringbone-wool-matching-jacket-vest?ID=7230565&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mens-graffiti-collage-graphic-t-shirt?ID=7673050&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-classic-chino-cotton-cap?ID=7000863&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:43:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-minneapolis-wool-blend-slim-fit-overcoat?ID=5023540&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/jockey-mens-supersoft-collection?ID=6791734&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-envelope-logo-print-t-shirt-created-for-macys?ID=7375873&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-tipped-sweater?ID=6935525&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-leo-sling-backpack?ID=7970490&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-camo-print-waffle-knit-thermal?ID=6593598&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-mens-knit-henley-t-shirt?ID=8286142&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-originals-mens-adicolor-collection?ID=5854414&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-contrast-trim-baseball-jacket?ID=7105960&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-originals-mens-hat?ID=4993388&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:43:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-pajama-pants?ID=8174211&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:43:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-logo-travel-case?ID=7805699&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-anchor-pajama-pants?ID=365930&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:43:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-aerobill-dri-fit-visor?ID=6724856&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:43:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-portfolio-slim-fit-stretch-navy-solid-suit-separates?ID=8259321&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-mk1-collection?ID=6363239&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-grey-wool-suit-separates?ID=8042955&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-graphic-t-shirt?ID=7649287&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-alphaskin-tech-fit-t-shirt?ID=5028428&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-sport-id-track-collection?ID=8023675&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-performance-cap?ID=7001532&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:43:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mens-one-night-only-long-sleeve-t-shirt?ID=8037672&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mens-relaxed-fit-ripped-jeans?ID=7673053&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hugo-c-fleming-mens-reversible-leather-belt?ID=2698980&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-logo-baseball-cap?ID=8302011&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:43:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-embossed-logo-belt?ID=7905157&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-camo-training-collection?ID=8030910&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-essentisals-three-stripe-woven-hookup?ID=8762001&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-cable-knit-cotton-sweater?ID=6081528&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-classic-fit-cotton-dress-shirt?ID=6293085&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/american-icons-calvin-klein-striped-tie-glen-plaid-dress-shirt-look?ID=1524777&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-statement-1981-mens-shorts?ID=8175925&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:43:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-classic-fit-airsoft-stretch-light-blue-navy-birdseye-suit-separates?ID=7986992&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-slim-fit-stretch-gray-sharkskin-suit-separates?ID=6666109&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:43:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-oxford-solid-tie?ID=8741112&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:43:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mesh-logo-baseball-cap?ID=8422955&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:43:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-bump-3.0-hat?ID=4286796&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-hi-tech-logo-graphic-long-sleeve-t-shirt?ID=6699524&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-linen-suit?ID=1284771&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-striped-waffle-knit-thermal?ID=6593596&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:44:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hugo-mens-identity-pajama-shorts?ID=8287691&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:44:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-navy-windowpane-suit-separates?ID=7806902&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-navy-pinstripe-vested-suit-separates?ID=6689147&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-shred-snapback-hat?ID=7454034&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-double-knit-cargo-joggers?ID=6606402&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-heathered-blitzing-3.0-stretch-fitted-cap?ID=4891775&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-ultra-soft-modal-jogger-pajama-pants?ID=8102635&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:44:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultra-flex-classic-fit-stripe-suit-separates?ID=8054601&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-chino-baseball-cap?ID=7001196&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-woven-plaid-shorts?ID=1992192&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:44:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-sportstyle-collection?ID=6919479&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-modern-essentials-mens-logo-pajama-joggers?ID=8175865&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:44:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-rev-reversible-beanie?ID=6260716&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-white-dinner-jacket-classic-fit-tuxedo-suit-separates?ID=8177914&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-pro-dri-fit-t-shirt-shorts-compression-leggings?ID=5691429&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-great-outdoors-graphic-t-shirt?ID=6605079&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-freedom-tshirt-collection?ID=7520514&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-julian-logo-stripe-sweater-created-for-macys?ID=6989830&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-red-linen-suit-separates?ID=8039355&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/armani-exchange-mens-logo-graphic-hat?ID=8302008&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-bahama-mens-islandzone-embroidered-pima-cotton-polo?ID=7105185&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-stretch-fit-hat?ID=6978350&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-j-class-embroidered-hat?ID=6670772&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-classic-fit-ultraflex-stretch-blue-plaid-suit-separates?ID=7877574&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-buffalo-plaid-cotton-pajama-pants?ID=8176091&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:44:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-relaxed-rainbow-logo-hat?ID=7933690&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-originals-logo-visor?ID=6828613&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-steel-slim-fit-non-iron-performance-stretch-textured-dress-shirt?ID=6970994&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-old-school-graphic-t-shirt?ID=7654577&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-linen-suit-separates?ID=8150947&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-big-tall-textured-blazer-vest-pants?ID=2069112&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-quarter-zip-sweater?ID=6627582&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-meshback-baseball?ID=8796902&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hugo-mens-logo-hoodie?ID=8287725&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:44:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-white-linen-suit-separates?ID=8323878&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-grey-sharkskin-big-tall-suit-separates?ID=635146&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-pony-chino-sports-hat?ID=5780622&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-pom-pom-cuffed-hat?ID=6942061&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-waterproff-baseball?ID=8796903&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-estate-cap?ID=6978339&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-colorblocked-sweater-created-for-macys?ID=6640960&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-schuster-hat?ID=6291707&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:44:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-knit-pajama-pants?ID=2404375&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:44:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-slim-fit-solid-dress-pants?ID=6198501&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:44:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-classic-fit-light-gray-light-blue-plaid-suit-separates?ID=8276233&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-sig-zane-ululoa-botanical-print-shirt?ID=7454038&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-tango-logo-hookup?ID=8760541&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-new-york-mens-printed-shirt?ID=7654634&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-pink-pony-cotton-baseball-cap?ID=6170032&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-essentials-cotton-logo-t-shirt?ID=6537683&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/steve-madden-mens-corduroy-backpack?ID=4954027&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:44:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-jeans-mens-stretch-twill-pants?ID=6814983&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:44:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-basketball-pro-sport-collection?ID=8425008&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:44:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-newsprint-logo-graphic-t-shirt?ID=7109542&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:45:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-adaptive-mens-julian-flag-sweater-with-hook-loop-closure?ID=7799729&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:45:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-gray-blue-windowpane-suit-separates?ID=8325700&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:45:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-running-collection?ID=8030992&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:45:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-big-tall-oxford-shirt?ID=5531788&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:45:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-th-flex-stretch-blue-chambray-suit-separates?ID=5954151&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:45:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-supreme-comfort-sleep-shorts?ID=8174217&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:45:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-pe-performance-baseball?ID=8796905&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:45:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-statement-1981-mens-logo-stripe-joggers?ID=8175931&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:45:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-100-wool-dress-pants?ID=709155&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:45:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-herringbone-comfort-cotton-pajama-shirt?ID=4455071&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:45:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-french-terry-joggers?ID=8269017&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:45:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/speedo-mens-hydrosity-anti-fog-goggles?ID=2855647&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:45:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-chino-baseball-cap?ID=7001197&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:45:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-tan-wool-suit-separates?ID=8045320&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:45:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-ultimate-climalite-cotton-dad-hat?ID=3601754&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:45:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-basketball-spotlight-collection?ID=8029283&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:45:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-p-wing-hybrid-down-hoodie-created-for-macys?ID=6994042&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:45:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-th-flex-stretch-black-white-plaid-sport-coat?ID=6298147&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:45:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-charcoal-blue-pinstripe-vested-suit-separates?ID=6697437&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:45:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-modern-essentials-mens-printed-pajama-shorts?ID=8175869&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:45:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-jeans-mens-straight-fit-ripped-jeans?ID=6605793&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:45:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-classic-fit-printed-oxford-shirt?ID=6606486&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:45:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-x-mens-extra-slim-fit-formal-white-french-cuff-dress-shirt-pre-tied-bow-tie?ID=6642323&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:45:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-air-flat-brim-hat?ID=7223301&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:45:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-crew-neck-t-shirt?ID=7367736&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:45:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-sportswear-just-do-it-collection?ID=8760500&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:45:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/armani-exchange-mens-logo-graphic-hat?ID=8302017&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:45:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-oxford-solid-tie?ID=1724113&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:45:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-linen-suit-jacket?ID=2655183&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:45:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-cotton-chino-baseball-cap?ID=6131043&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:45:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-ardin-cap?ID=2888848&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-steel-extra-slim-fit-non-iron-performance-stretch-herringbone-dress-shirt?ID=6642327&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:46:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-preseason-stretch-fit-hat?ID=6978355&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-big-tall-colorblocked-track-jacket?ID=7154061&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:46:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-ultra-soft-modal-pajama-shorts?ID=8102633&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-adizero-superlite-hat?ID=7454610&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-originals-blue-camo-collection?ID=8761731&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:46:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-sea-breeze-pique-knit-t-shirt?ID=6498536&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-tuxedo-suit-separates?ID=8031700&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:46:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-dri-fit-knit-training-hookup?ID=8031534&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:46:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-buffalo-plaid-pajama-shorts?ID=5712375&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-plaid-pajama-shirt?ID=8174221&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-alpine-cap?ID=7771739&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-washed-chunky-beanie?ID=7961767&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-windowpane-plaid-cotton-pajama-pants?ID=4455095&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-classic-fit-airsoft-stretch-blue-gray-mini-grid-suit-separates?ID=8519687&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:46:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-harden-basketball-collection?ID=8023892&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:46:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-charcoal-windowpane-suit-separates?ID=8325598&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:46:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-ultra-soft-pima-cotton-supreme-comfort-knit-pajama-pants?ID=1710370&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-mk-1-heatgear-collection?ID=6642091&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:46:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-patterned-sport-coats?ID=7214846&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:46:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-relaxed-logo-cap?ID=6828605&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-washable-slim-fit-pants?ID=2771163&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:46:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-oxford-baseball-cap?ID=7000916&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-suit-separates?ID=1359945&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:46:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-downhill-skier-stadium-hat?ID=6641291&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/j-balvin-x-guess-collection?ID=8098873&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:46:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-corp-fitted-hat?ID=5707422&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mens-paradise-graphic-t-shirt?ID=7673052&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:46:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-logo-graphic-pullover?ID=6127240&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:46:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-locked-hat?ID=6291655&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-woven-plaid-robe?ID=1992193&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-4-pack-brief-suprima-cotton-underwear?ID=2481505&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:46:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-thflex-stretch-light-gray-chambray-suit-separates?ID=8329305&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:46:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-statement-1981-mens-logo-cotton-t-shirt?ID=8175932&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-palm-graphic-t-shirt-created-for-macys?ID=8341698&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:46:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-tango-climalite-soccer-shorts?ID=5747006&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:46:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-signature-eastport-striped-sweater-created-for-macys?ID=6640962&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:46:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-ultraflex-stretch-gray-sharkskin-suit-separates?ID=7878766&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:46:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-court-aerobill-rafa-tennis-hat?ID=4429993&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-camo-trucker-hat?ID=6828614&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-colorblocked-track-pants?ID=6712478&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:46:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-space-dyed-logo-long-sleeve-t-shirt?ID=6498525&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-burgee-flag-cap?ID=6991262&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-denim-mens-summit-shirt?ID=7075071&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:46:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-quarter-zip-sweater?ID=7105966&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:46:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-windowpane-plaid-cotton-pajama-shirt?ID=4455064&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-sleepwear-blue-herringbone-short?ID=718529&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-therma-basketball-hookup?ID=7371072&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:46:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-waffle-knit-thermal-with-p-logo?ID=6697495&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-waffle-knit-jogger-pants?ID=6593615&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-tartan-bucket-hat?ID=6994611&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:46:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-burgundy-gray-tartan-plaid-wool-matching-jacket-vest?ID=7231939&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:46:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-modern-essentials-mens-pajama-shorts?ID=8175864&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-supreme-comfort-knit-pajama-shorts?ID=1710371&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:46:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-big-tall-anchor-pocket-t-shirt?ID=5531790&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:46:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/jockey-mens-classics-collection?ID=1518424&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:47:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-classic-fit-p-wing-graphic-cotton-t-shirt?ID=7014068&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:47:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-classic-fit-airsoft-stretch-light-blue-plaid-windowpane-suit-separates?ID=8322370&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:47:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-x-fit-slim-fit-natural-stretch-blue-plaid-suit-separates?ID=8324262&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:47:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-mixed-media-colorblocked-zip-front-jacket?ID=7751825&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:47:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-plaid-pajama-pants?ID=8174225&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:47:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-cotton-pajama-pants?ID=7367788&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:47:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-bahama-mens-cayman-island-relaxed-fit-jeans?ID=2885114&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:47:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-buffalo-plaid-cotton-pajama-pants?ID=5712378&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:47:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-eagle-logo-graphic-t-shirt?ID=6699192&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:47:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/perry-ellis-mens-portfolio-slim-fit-stretch-gray-solid-suit-separates?ID=8226082&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:47:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-mens-colorblocked-full-zip-hoodie?ID=7205041&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:47:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-pajama-shorts?ID=7367740&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:47:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-x-mens-steel-extra-slim-fit-non-iron-performance-herringbone-dress-shirt?ID=5712904&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:47:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-jeans-mens-relaxed-fit-jeans-collection?ID=9064382&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:47:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-th-flex-performance-plaid-suit-separates?ID=5225413&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:47:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-running-collection?ID=8423311&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:47:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-baseball-jacket-logo-graphic-t-shirt-side-stripe-track-pants?ID=8298112&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:47:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-knit-sleep-tee-shirt?ID=2404373&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:47:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-painter-hat?ID=6789662&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:47:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-z.n.e.-zip-hoodie?ID=5779672&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:47:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-mesh-polo-shirts-all-sizes?ID=8924467&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:47:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-kors-mens-classic-fit-airsoft-stretch-solid-suit-jacket?ID=5629076&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:47:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-rugby-shirt?ID=6663633&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:47:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-fit-light-brown-blue-multi-check-wool-jacket-vest-separates?ID=7242061&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:47:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-modern-fit-flex-stretch-tan-suit-separates?ID=5917723&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:47:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-adaptive-mens-rugby-shirt-with-magnetic-closures?ID=7285859&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:47:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-big-tall-cotton-pajama-shorts?ID=7367751&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:47:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/under-armour-mens-logo-pom-pom-beanie?ID=6260723&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:47:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-slim-fit-th-flex-stretch-gray-white-stripe-suit-separates?ID=6575653&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:47:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-new-york-stretch-casual-pants?ID=6785749&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:47:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/speedo-mens-performance-marina-9-swim-trunks?ID=649440&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:47:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-sullivan-slim-cotton-jeans?ID=6606164&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:47:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-suit-separates?ID=8081585&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:48:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-colorblocked-split-logo-t-shirt?ID=6948241&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hurley-mens-league-snapback-baseball-hat?ID=6291653&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:48:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-ultraflex-classic-fit-tan-linen-suit-separates?ID=8323877&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:48:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-cotton-jogger-pants?ID=8174587&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:48:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-steel-mens-big-tall-classic-fit-non-iron-herringbone-dress-shirt?ID=2761368&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:48:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-new-york-mens-confetti-print-shirt?ID=8425609&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-harwich-plaid-pajama-pants?ID=803680&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Pajamas, Lounge & Sleepwear', '', '']
2019-04-28 11:48:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-adicolor-velour-hookup?ID=7601570&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-dry-woven-training-collection?ID=8029612&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:48:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-americana-collection?ID=8769305&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:48:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-camouflage-logo-bucket-hat?ID=6828618&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:48:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-logo-graphic-beanie?ID=6210231&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:48:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-athletic-socks-6-pack?ID=1717985&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:48:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-mens-classic-regular-fit-indigo-textured-suit-separates?ID=7820894&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:48:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-denim-mens-peace-cowichan-sweater?ID=7075077&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-featherlight-cap?ID=1788691&CategoryID=197651> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Men', 'Hats, Gloves & Scarves', '', '']
2019-04-28 11:48:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/be-connected-diaper-bag-stroller-clips?ID=7396299&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-featherweight-quilted-buckle-diaper-bag?ID=6906948&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/i.n.c.-farahh-nylon-backpack-created-for-macys?ID=8989464&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-featherweight-quilted-buckle-diaper-bag?ID=6906950&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/be-sporty-diaper-backpack?ID=7396335&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/j.l.-childress-5-in-1-diaper-bag-organizer-grey-chevron?ID=7932654&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/betsey-johnson-charmed-im-sure-crossbody?ID=8094166&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/be-prepared-diaper-bag?ID=7396307&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-kimono-tapestry-metallic-poppy-tote?ID=7212183&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-san-francisco-giants-embossed-nylon-foldover-crossbody?ID=6424201&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-nola-featherweight-diaper-bag?ID=6906954&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/rosie-pope-highbury-hill-diaper-backpack?ID=7932636&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-diaper-bag-clutch?ID=6906944&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/chelsea-downtown-chic-diaper-bag?ID=1141694&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', '', '', '']
2019-04-28 11:48:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skip-hop-forma-diaper-backpack?ID=4922532&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:48:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-nola-featherweight-diaper-bag?ID=6906952&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-new-york-diaper-bag?ID=6906967&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-new-york-diaper-bag?ID=6906966&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-berlin-diaper-bag?ID=6906961&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-diaper-bag-clutch?ID=6906941&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skip-hop-duo-diaper-backpack?ID=6114732&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:48:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/fossil-jayda-printed-tote?ID=6805080&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/babymel-george-water-resistant-diaper-backpack?ID=8507452&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:48:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-chicago-backpack-diaper-bag?ID=6906973&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-quilted-detail-camera-bag?ID=6856218&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-taylor-diaper-backpack?ID=8507524&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:48:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/babymel-cara-ultra-lite-diaper-bag?ID=8507477&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:48:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kipling-experience-laptop-backpack?ID=7105674&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-jude-convertible-diaper-bag?ID=8507508&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:48:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hobobe-messenger-diaper-bag?ID=7396306&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-chicago-backpack-diaper-bag?ID=6906970&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-chicago-backpack-diaper-bag?ID=6906976&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/radley-london-clouds-hill-backpack?ID=7454256&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-hero-water-resistant-backpack-breast-pump-diaper-bag?ID=8507518&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:48:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nine-west-eloa-crossbody?ID=6684404&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/robyn-convertible-diaper-backpack?ID=8507479&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:48:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/be-light-tote-diaper-bag?ID=8949662&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:48:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-hero-backpack-breast-pump-diaper-bag?ID=8507523&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:48:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-nola-tote-diaper-bag?ID=6906982&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:48:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-whitney-petal-quilted-leather-shoulder-bag?ID=9353477&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-whitney-bicolor-leather-shoulder-bag?ID=6913538&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:48:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skip-hop-duo-signature-diaper-bag?ID=4922427&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:48:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/better-be-messenger-diaper-bag?ID=7396296&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nine-west-darcelle-small-crossbody?ID=6124055&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/jujube-helix-diaper-bag-xy-collection?ID=7396317&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/coach-crystal-border-rivets-parker-18-shoulder-bag?ID=6811722&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-tashia-backpack?ID=7788593&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-ohio-state-buckeyes-foldover-crossbody-purse?ID=5498861&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-usc-trojans-foldover-crossbody-purse?ID=5498917&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/babymel-george-water-resistant-diaper-backpack?ID=8507454&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nine-west-inaya-shoulder-bag-created-for-macys?ID=9337621&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/babymel-luna-ultra-lite-diaper-backpack?ID=8507476&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-signature-plus-size-fanny-pack-created-for-macys?ID=9360423&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['', '', '', '']
2019-04-28 11:49:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/i.n.c.-cissy-quilted-tote-created-for-macys?ID=6703817&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-jaen-rugby-stripe-tote?ID=7970691&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-travel-expandable-tote-diaper-bag?ID=8507522&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-diaper-bag-clutch?ID=6906936&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skip-hop-greenwich-simply-chic-diaper-backpack?ID=4922449&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-huntley-embossed-logo-plus-size-fanny-pack?ID=7655864&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-hero-water-resistant-backpack-breast-pump-diaper-bag?ID=8507517&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-signature-quilt-zip-zip-satchel-created-for-macys?ID=4919912&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:49:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dkny-paige-leather-medium-satchel-created-for-macys?ID=5870255&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:49:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-pittsburgh-steelers-foldover-crossbody-purse?ID=5498879&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-nola-backpack-diaper-bag?ID=6906980&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/the-sak-fairmont-crochet-bucket-small-hobo?ID=8455208&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-nola-featherweight-diaper-bag?ID=6906956&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-maxi-quilt-signature-crossbody-created-for-macys?ID=2211857&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:49:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kipling-angie-crossbody?ID=9010554&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-bark-leaves-luzille-embossed-leather-backpack-created-for-macys?ID=6716069&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-diaper-bag-clutch?ID=6906945&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-st.-louis-cardinals-foldover-crossbody-purse?ID=5498907&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-los-angeles-dodgers-pebble-continental-clutch?ID=6119941&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/i.n.c.-riverton-small-crossbody-created-for-macys?ID=9336990&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-beaded-floral-limited-edition-whitney-shoulder-bag?ID=7116214&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-penn-state-nittany-lions-triple-zip-crossbody-bag?ID=2799022&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-green-bay-packers-nylon-triple-zip-crossbody?ID=5123556&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/rosie-pope-warren-diaper-tote?ID=8094521&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lillian-rose-construction-builder-daddy-diaper-bag?ID=9059807&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-dryden-flap-leather-backpack?ID=6418175&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:49:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-new-york-diaper-bag?ID=6906969&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-gracchi-patent-leather-vintage-frame-satchel?ID=6716440&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/babymel-anya-faux-leather-diaper-bag?ID=8507456&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-featherweight-quilted-buckle-diaper-bag?ID=6906946&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skip-hop-mainframe-wide-open-diaper-backpack?ID=6114724&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lillian-rose-property-of-mommy-diaper-bag?ID=9059809&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-eden-faux-leather-diaper-bag?ID=8507494&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-pittsburgh-steelers-nylon-triple-zip-crossbody?ID=5123567&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-cherie-status-carryall-satchel?ID=6619537&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/bcbgeneration-houndstooth-backpack?ID=7908839&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-whitney-quilted-top-handle-satchel?ID=6913495&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/super-star-travel-diaper-bag?ID=8949679&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-rosie-north-south-crossbody?ID=7483888&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-th-flag-flap-backpack?ID=7483910&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-stevie-luxe-diaper-bag?ID=8507526&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-nola-featherweight-diaper-bag?ID=6906958&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/starlet-travel-diaper-bag?ID=8949678&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-heritage-cadiz-top-handle-satchel?ID=7093219&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-heritage-ricadi-smooth-leather-chain-crossbody?ID=9308954&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skip-hop-chelsea-downtown-chic-diaper-backpack?ID=4922431&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/rosie-pope-sloane-diaper-bag?ID=7932635&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-luzille-floral-leather-backpack?ID=7093215&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/i.n.c-elliah-hobo-created-for-macys?ID=8012866&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-nola-tote-diaper-bag?ID=6906981&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lillian-rose-daddy-pixelated-camouflage-military-diaper-bag?ID=9059805&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/coach-edie-31-in-pebble-leather-shoulder-bag?ID=7885329&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lillian-rose-property-of-daddy-diaper-bag?ID=9059808&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/robyn-convertible-diaper-backpack?ID=8507455&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/super-star-travel-diaper-bag?ID=7396303&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kipling-disneys-mickey-mouse-hip-hurray-tote-bag?ID=8024677&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/b.f.f.-diaper-bag?ID=8949646&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/babymel-evie-quilted-diaper-bag?ID=8507482&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:49:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/rosie-pope-addison-lane-diaper-bag-carryall?ID=7932637&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:49:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-cleveland-indians-exclusive-wristlet?ID=5498923&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/royce-new-york-backpack-with-15-laptop-sleeve?ID=7808801&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:49:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-hero-water-resistant-backpack-breast-pump-diaper-bag?ID=8507516&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/super-star-travel-diaper-bag?ID=8949648&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kate-spade-new-york-jackson-street-melisse-small-pebble-leather-crossbody?ID=4754898&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-nola-featherweight-diaper-bag?ID=6906955&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/be-packed-diaper-backpack?ID=7396328&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-dallas-cowboys-foldover-crossbody-purse?ID=5498777&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-featherweight-quilted-buckle-diaper-bag?ID=6906951&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-diaper-bag-clutch?ID=6906940&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-pebble-leather-piper-small-crossbody?ID=4827354&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-pebble-leather-hobo?ID=1638867&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/coach-parker-shoulder-bag-in-ombre-quilted-leather?ID=7885333&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/robyn-convertible-diaper-backpack-faux-leather?ID=8507473&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/be-light-tote-diaper-bag?ID=7396294&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-nola-backpack-diaper-bag?ID=6906979&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-lizard-embossed-leather-zip-zip-satchel-created-for-macys?ID=8763043&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-rhea-zip-studded-backpack?ID=6913465&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nine-west-devanna-tote?ID=6531146&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-berlin-diaper-bag?ID=6906962&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/starlet-travel-diaper-bag?ID=7396298&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-zancona-embossed-leather-tote?ID=6205257&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/super-be-tote-diaper-bag?ID=8949663&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-nylon-crossbody?ID=1227828&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-nola-featherweight-diaper-bag?ID=6906959&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-signature-quilted-small-hobo-crossbody-created-for-macys?ID=5518812&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-chicago-backpack-diaper-bag?ID=6906978&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kipling-gabby-shoulder-bag?ID=6566733&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vector-diaper-backpack?ID=7396321&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/i.n.c.-cissy-quilted-satchel-created-for-macys?ID=6703813&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-junie-bicolor-pebble-leather-tote?ID=6913542&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/be-sporty-diaper-backpack?ID=8949672&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-belfast-belt-bag?ID=7274761&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/giani-bernini-block-signature-stripe-tote-created-for-macys?ID=6597463&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-signature-fanny-pack-created-for-macys?ID=4393870&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['', '', '', '']
2019-04-28 11:50:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/everyday-tote-diaper-bag?ID=7396329&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/fossil-campbell-leather-tote?ID=9308206&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-poppy-luxe-diaper-bag?ID=8507528&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-dryden-mini-debby-ii-drawstring-crocodile-embossed-leather-bag?ID=8157201&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-charlotte-leather-diaper-bag?ID=8507538&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/i.n.c.-veronica-chain-clutch-created-for-macys?ID=9338135&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/babymel-cara-ultra-lite-diaper-bag?ID=8507475&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/encore-tote-tote-diaper-bag?ID=8949683&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-atlanta-falcons-triple-zip-crossbody-bag?ID=2965319&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-dryden-marcy-striped-leather-satchel?ID=8157211&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-pebble-leather-zip-top-satchel?ID=8763207&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-travel-backpack-diaper-bag?ID=8507503&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dkny-hutton-satchel-created-for-macys?ID=7115329&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-travel-backpack-diaper-bag?ID=8507535&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-penn-state-nittany-lions-florentine-zip-around-wallet?ID=5734279&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/forever-backpack-diaper-backpack?ID=8949668&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-diaper-bag-clutch?ID=6906938&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-san-francisco-49ers-foldover-crossbody-purse?ID=5498885&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kate-spade-new-york-sam-nylon-medium-satchel?ID=7145200&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/b.f.f.-diaper-bag?ID=7396286&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-bark-leaves-caprera-embossed-leather-crossbody-created-for-macys?ID=6715980&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-new-york-diaper-bag-studs?ID=6906968&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-caprera-heritage-smooth-leather-crossbody?ID=6596923&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/garden-printed-totes?ID=8993253&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 397, in map_and_calculate
    item_weight = float(bizrules_match_df['avg_weight'])
  File "/anaconda3/lib/python3.6/site-packages/pandas/core/series.py", line 115, in wrapper
    return converter(self.iloc[0])
ValueError: could not convert string to float: 
2019-04-28 11:50:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-new-york-diaper-bag?ID=6906965&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/everyday-tote-diaper-bag?ID=8949688&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-velvet-potenaz-frame-clutch?ID=6716433&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-dryden-marcy-croc-embossed-leather-satchel?ID=8157212&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/babymel-evie-quilted-diaper-bag?ID=8507438&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:50:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-seattle-seahawks-triple-zip-crossbody-bag?ID=5403266&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-chicago-backpack-diaper-bag?ID=6906971&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:50:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-aberdeen-stained-leather-backpack?ID=6716453&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:50:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-diaper-bag-clutch?ID=6906937&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adrianna-papell-kennis-satin-pouchette-clutch?ID=9338122&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/coach-parker-small-shoulder-bag-in-refined-leather?ID=9296343&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-diaper-bag-clutch?ID=6906943&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-signature-quilt-ruby-small-bag-created-for-macys?ID=4919906&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:51:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-nola-featherweight-diaper-bag?ID=6906953&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-indianapolis-colts-exclusive-wristlet?ID=5465777&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/clone-diaper-bag?ID=7396322&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-kym-leather-diaper-bag?ID=8507520&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-stella-turquoise-tooled-leather-shoulder-bag?ID=4755597&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lillian-rose-operational-camouflage-military-daddy-diaper-bag?ID=9059806&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/quinny-x-rachel-zoe-diaper-bag?ID=6742126&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/super-be-tote-diaper-bag?ID=7396290&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/b.f.f.-diaper-bag?ID=8949664&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-berlin-quilted-diaper-bag?ID=6906963&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/macys-walking-dog-large-tote-created-for-macys?ID=4509778&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/coach-turnlock-crossbody-in-refined-leather?ID=6811653&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-featherweight-quilted-buckle-diaper-bag?ID=6906947&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-velia-crackled-rose-garden-satchel?ID=8413888&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-chicago-backpack-diaper-bag?ID=6906975&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/be-prepared-diaper-bag?ID=8949669&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-janie-crossbody?ID=6331211&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/babymel-luna-ultra-lite-diaper-backpack?ID=8507474&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/wherever-weekender-diaper-bag?ID=7396331&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-berlin-quilted-diaper-bag?ID=6906964&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/hobobe-messenger-diaper-bag?ID=8949665&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/robyn-convertible-diaper-backpack?ID=8507457&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/forever-backpack-diaper-backpack?ID=7396333&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-nola-featherweight-diaper-bag?ID=6906957&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-renaissance-coin-lanza-crossbody?ID=7093218&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kipling-alvar-crossbody?ID=9336915&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-chicago-backpack-diaper-bag?ID=6906974&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-travel-backpack-diaper-bag?ID=8507502&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kipling-alvy-2-in-1-convertible-backpack-tote-bag?ID=9012716&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-featherweight-quilted-buckle-diaper-bag?ID=6906949&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-stevie-luxe-diaper-bag?ID=8507527&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-rienzo-laser-floral-leather-satchel?ID=7093228&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/robyn-convertible-diaper-backpack-faux-leather?ID=8507472&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-chicago-cubs-pebble-ginger-crossbody?ID=6119938&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/macys-star-small-coin-purse-created-for-macys?ID=4517388&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/quinny-x-rachel-zoe-diaper-bag?ID=6742125&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-pebble-leather-crossbody?ID=1851923&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:51:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/wherever-weekender-diaper-bag?ID=8949667&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-kamryn-tote?ID=9337481&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-kym-leather-diaper-bag?ID=8507519&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-chicago-backpack-diaper-bag?ID=6906977&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/the-sak-limited-edition-crochet-bali-beads-120-hobo?ID=8852073&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-beacon-ziptop-smooth-leather-tote?ID=6331197&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-emma-leather-diaper-bag?ID=8507493&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-granada-burnished-tooled-leather-crossbody?ID=6785440&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-ginny-pebble-leather-camera-bag?ID=5225249&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-amelia-top-zip-small-tote?ID=6913461&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/babymel-bella-diaper-bag?ID=8507435&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/macys-new-york-large-shopper-created-for-macys?ID=2725703&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:51:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-minnesota-vikings-triple-zip-crossbody-bag?ID=2965387&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-taylor-diaper-backpack?ID=8507525&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/storksak-travel-expandable-tote-diaper-bag?ID=8507521&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/bcbgeneration-raphaela-day-crossbody?ID=7908838&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dkny-paige-leather-large-satchel-created-for-macys?ID=5882804&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:51:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dkny-hutton-satchel-created-for-macys?ID=9309448&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-chicago-backpack-diaper-bag?ID=6906972&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-g-vision-clear-belt-bag?ID=7046933&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skip-hop-nolita-neoprene-diaper-backpack?ID=4925262&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kalencom-berlin-vegan-leather-diaper-bag?ID=6906960&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', 'All Baby Gear', '', '']
2019-04-28 11:51:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/everyday-tote-diaper-bag?ID=8949666&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 393, in map_and_calculate
    raise Exception("Could not find qarece category mapping in profit margin file for hierarchy of %s" % (qarece_category_list))
Exception: Could not find qarece category mapping in profit margin file for hierarchy of ['Kids', "All Kids' Accessories", '', '']
2019-04-28 11:51:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-heritage-moretto-satchel?ID=7093225&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:51:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dooney-bourke-carolina-ruby-satchel?ID=7094241&CategoryID=27686> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-station-memory-foam-slip-resistant-oil-resistant-non-marking-dress-comfort-oxford?ID=7480838&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:52:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-drive-memory-foam-slip-on-driving-moc-loafer?ID=7480827&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:52:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-mens-enzo-knit-nm-casual-sneakers-from-finish-line?ID=7722442&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-mens-990-v4-running-sneakers-from-finish-line?ID=6936306&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-benton-memory-foam-classic-lace-up-wingtip-hybrid-sneaker-dress-comfort-brogue?ID=7480819&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:52:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-air-max-90-ez-casual-sneakers-from-finish-line?ID=6402619&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-donald-slip-resistant-oil-resistant-non-marking-dress-comfort-oxford?ID=7480826&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:52:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-greenpoint-dress-casual-cushioned-comfort-slip-on-loafer?ID=7479782&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:52:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/mark-nason-mens-los-angeles-hardee-casual-dress-sneakers-from-finish-line?ID=7262474&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-nu-journal-waterproof-memory-foam-slip-resistant-classic-wingtip-dress-comfort-oxford?ID=7479788&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:52:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-mens-574-casual-sneakers-from-finish-line?ID=6713140&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-townsend-memory-foam-classic-dress-comfort-cap-toe-oxford?ID=7479798&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:52:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-mens-chuck-taylor-hi-top-casual-sneakers-from-finish-line?ID=753210&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:52:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-herman-classic-dress-comfort-kiltie-tassel-loafer?ID=7480830&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:52:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-mens-delson-clenton-casual-sneakers-from-finish-line?ID=7144626&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-leslie-oxfords?ID=7084281&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/steve-madden-mens-difranco-leather-bit-slip-ons?ID=7686910&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-mean-waterproof-memory-foam-slip-resistant-classic-dress-comfort-desert-boot?ID=7479786&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:52:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-laurel-chukka-boots?ID=6729601&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/sperry-mens-kennedy-penny-loafers?ID=6826848&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:52:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/cole-haan-mens-original-grand-cap-toe-ii-boots?ID=6538132&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-xplr-casual-sneakers-from-finish-line?ID=7262414&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-williamsburg-dress-casual-cushioned-comfort-oxford?ID=7479799&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:52:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/unlisted-by-kenneth-cole-mens-russell-boots?ID=6605729&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/levis-mens-monterey-denim-sneakers?ID=5697202&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-rhodes-memory-foam-dress-comfort-casual-fashion-cap-toe-chukka-boot?ID=7480836&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:52:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-xplr-casual-sneakers-from-finish-line?ID=6936246&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-tubular-dusk-casual-sneakers-from-finish-line?ID=6750979&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ax-armani-exchange-mens-athletic-sneakers?ID=5827888&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:52:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-nu-times-waterproof-s.u.p.r.o.-sock-comfort-dress-oxford?ID=7479790&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:53:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-mens-enzo-premium-mesh-casual-sneakers-from-finish-line?ID=7135416&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-unisex-chuck-taylor-ox-leather-casual-sneakers-from-finish-line?ID=6897183&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-flex-experience-run-7-running-sneakers-from-finish-line?ID=5923857&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-reaction-mens-debate-loafers?ID=6640930&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-air-max-axis-premium-casual-sneakers-from-finish-line?ID=7145474&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-mens-990-v4-running-sneakers-from-finish-line?ID=6713141&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-king-memory-foam-water-repellent-slip-resistant-dress-casual-comfort-slip-on?ID=7479785&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:53:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-shipley-memory-foam-classic-dress-comfort-oxford?ID=7479791&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:53:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-ebernon-mid-winter-casual-sneakers-from-finish-line?ID=7884467&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:53:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/fila-mens-forerunner-18-casual-sneakers-from-finish-line?ID=7045238&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-apt-memory-foam-dress-casual-comfort-oxford?ID=7479776&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:53:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-times-s.u.p.r.o.-sock-plain-toe-dress-comfort-oxford?ID=7479794&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:53:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-air-max-torch-4-running-sneakers-from-finish-line?ID=6152999&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-bowen-memory-foam-casual-comfort-boat-shoe-loafer?ID=7480821&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:53:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-bamboo2-classic-dress-comfort-casual-huarache?ID=7480820&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:53:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-cyprus-memory-foam-dress-casual-comfort-double-monk-strap-shoe?ID=7480824&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:53:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-mens-work-relaxed-fit-flex-advantage-sr-sneakers-from-finish-line?ID=2189672&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-mens-574-casual-sneakers-from-finish-line?ID=6861411&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-reaction-mens-grove-chukka-boots?ID=6640931&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/sorel-mens-madson-sport-waterproof-hiker-boots?ID=8954314&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/cole-haan-mens-pinch-weekender-slip-ons?ID=4579463&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-colby-memory-foam-dress-comfort-classic-runoff-toe-moc-embellished-saddle-bit-slip-on-loafer?ID=7479778&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:53:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-fit-memory-foam-slip-on-dress-casual-comfort-loafer?ID=7479780&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:53:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-mens-501-casual-sneakers-from-finish-line?ID=5246736&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-mens-chuck-taylor-70-trech-tech-high-top-casual-sneakers-from-finish-line?ID=6820403&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-bangor-memory-foam-dress-casual-comfort-chukka-boot?ID=7480818&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:53:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-mens-chuck-taylor-low-top-sneakers-from-finish-line?ID=872056&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Kids', 'Finish Line Athletic Shoes', '', '']
2019-04-28 11:53:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-unisex-chuck-taylor-ox-leather-casual-sneakers-from-finish-line?ID=6657007&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-memory-foam-dress-taylor-dress-comfort-classic-wingtip-oxford?ID=7479793&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:53:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-kyrie-flytrap-basketball-sneakers-from-finish-line?ID=6897315&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/steve-madden-mens-coine-velvet-smoking-slipper?ID=2992351&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:53:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/bar-iii-mens-henry-suede-derby-shoes-created-for-macys?ID=6373210&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:54:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-mens-gowalk-evolution-ultra-rapids-walking-sneakers-from-finish-line?ID=7145435&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:54:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vlado-mens-venice-wingtip-knitted-textile-casual-sneakers-from-finish-line?ID=6364045&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:54:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-manager-memory-foam-slip-resistant-oil-resistant-non-marking-dress-comfort-slip-on?ID=7480834&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:54:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-calgary-memory-foam-dress-casual-fashion-comfort-oxford?ID=7480822&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:54:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-manual-memory-foam-slip-on-driving-moc-loafer?ID=7480832&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:54:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-seattle-classic-dress-comfort-chukka-boot?ID=7479792&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:54:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-air-max-torch-4-running-sneakers-from-finish-line?ID=6856896&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:54:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-everest-memory-foam-dress-comfort-casual-slip-on-loafer?ID=7480828&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:54:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-benassi-jdi-slide-sandals-from-finish-line?ID=6856866&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:54:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-i-5923-runner-casual-sneakers-from-finish-line?ID=6976737&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:54:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/rockport-mens-leather-sharp-ready-chukkas?ID=6069120&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:54:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tallia-mens-treviso-loafers?ID=7774857&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:54:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-mitch-memory-foam-casual-comfort-boat-shoe-oxford?ID=7480833&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:54:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-highland-memory-foam-dress-casual-comfort-oxford?ID=7480831&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:54:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-method-waterproof-memory-foam-slip-resistant-classic-dress-comfort-oxford?ID=7479787&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:54:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-alphabounce-instinct-clima-running-sneakers-from-finish-line?ID=7045198&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:54:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-mens-990-v4-running-sneakers-from-finish-line?ID=6820477&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:54:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-james-memory-foam-dress-comfort-classic-chukka-boot?ID=7479784&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:54:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-kyrie-flytrap-basketball-sneakers-from-finish-line?ID=6936357&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:54:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-nu-media-waterproof-memory-foam-slip-resistant-classic-dress-comfort-slip-on?ID=7479789&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:54:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-mens-relven-hemson-casual-sneakers-from-finish-line?ID=7145438&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:54:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-mens-nampa-groton-wide-width-casual-sneakers-from-finish-line?ID=6861389&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:54:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/i.n.c.-mens-cheetah-alpine-boots-created-for-macys?ID=7065389&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:54:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-mens-carnaby-evo-318-9-sneakers?ID=6750051&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:54:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-superstar-casual-sneakers-from-finish-line?ID=3524239&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:54:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-tijuana-classic-dress-comfort-casual-huarache?ID=7480840&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:54:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-reaction-mens-big-screens?ID=4488204&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-roshe-run-casual-sneakers-from-finish-line?ID=1978768&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-mens-chuck-taylor-ox-casual-sneakers-from-finish-line?ID=2443195&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:55:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-mens-townsend-low-top-lace-up-sneakers?ID=7481945&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-tanjun-racer-casual-sneakers-from-finish-line?ID=4825857&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-mens-frasier-118-2-sandals-created-for-macys?ID=5735780&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/snkr-project-mens-park-avenue-casual-sneakers-from-finish-line?ID=6861408&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-roshe-run-casual-sneakers-from-finish-line?ID=7604956&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-rockland-memory-foam-dress-casual-comfort-chelsea-boot?ID=7480835&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:55:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-hooper-memory-foam-classic-dress-comfort-boot?ID=7479783&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:55:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-mens-court-100-sneakers?ID=6429562&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/steve-madden-mens-jonnie-boots-created-for-macys?ID=8503478&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-mens-dance-leather-lace-up-oxfords?ID=6641004&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-mens-chuck-taylor-street-mid-casual-sneakers-from-finish-line?ID=7006188&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-crown-memory-foam-water-repellent-slip-resistant-dress-casual-comfort-oxford?ID=7479779&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:55:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-steward-memory-foam-water-repellent-non-marking-slip-resistant-dress-comfort-oxford?ID=7480839&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:55:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-xplr-casual-sneakers-from-finish-line?ID=6976739&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-depot-memory-foam-slip-resistant-oil-resistant-non-marking-dress-comfort-slip-on?ID=7480825&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:55:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-flex-run-2018-running-sneakers-from-finish-line?ID=6293892&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-boys-kyrie-flytrap-basketball-sneakers-from-finish-line?ID=7604925&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Kids', 'Finish Line Athletic Shoes', '', '']
2019-04-28 11:55:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vlado-mens-atlas-3-high-top-casual-sneakers-from-finish-line?ID=6820407&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-mens-chuck-taylor-street-mid-varsity-jacket-casual-sneakers?ID=6784722&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-i-5923-runner-casual-sneakers-from-finish-line?ID=6820353&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-mens-chuck-taylor-70-trech-tech-high-top-casual-sneakers-from-finish-line?ID=6897181&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-brooklyn-cushioned-comfort-leather-dress-casual-slip-on-loafer?ID=7479777&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:55:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/unlisted-by-kenneth-cole-mens-design-30305?ID=4836143&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nosox-mens-wino-comfort-cushioned-flexible-breathable-casual-slip-on-sneaker?ID=7480841&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:55:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-mens-chuck-taylor-hi-top-casual-sneakers-from-finish-line?ID=2443196&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:55:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-service-memory-foam-slip-resistant-oil-resistant-non-marking-sr-dress-comfort-oxford?ID=7480837&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:55:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-tribeca-classic-dress-comfort-chelsea-boot?ID=7479796&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:55:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/k-swiss-mens-court-casper-casual-sneakers-from-finish-line?ID=6713095&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-mens-chuck-taylor-street-mid-varsity-jacket-casual-sneakers-from-finish-line?ID=6751032&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/stacy-adams-mens-kallan-plain-toe-lace-up-oxfords?ID=2923803&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-sobakov-casual-sneakers-from-finish-line?ID=7884072&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/cole-haan-mens-pinch-weekender-slip-ons?ID=7122187&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-mens-enzo-mesh-casual-sneakers-from-finish-line?ID=7449879&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-cyprus-perf-memory-foam-dress-casual-comfort-double-monk-strap-shoe?ID=7480823&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:55:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-mens-chuck-taylor-all-star-sneakers-from-finish-line?ID=7884451&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:55:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-mens-chuck-taylor-all-star-sneakers-from-finish-line?ID=745019&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:55:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-mens-mcneil-sneakers?ID=6787253&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-air-max-invigor-print-running-sneakers-from-finish-line?ID=6489887&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:55:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-air-monarch-sneakers-from-finish-line?ID=745259&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:55:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-mens-roshe-run-casual-sneakers-from-finish-line?ID=1879003&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-mens-chuck-taylor-70-high-street-mid-cut-casual-sneakers-from-finish-line?ID=6656075&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-mens-enzo-street-knit-casual-sneakers-from-finish-line?ID=7449880&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-argos-memory-foam-dress-comfort-casual-fashion-cap-toe-chelsea-boot?ID=7480817&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:56:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/cole-haan-mens-goldwyn-2.0-cross-band-sandals?ID=8305520&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lacoste-mens-l.12.12-unlined-leather-sneakers?ID=5658881&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-originals-pod-s3.1-casual-sneakers-from-finish-line?ID=7144602&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-mens-equalizer-3.0-sumnin-wide-width-walking-sneakers-from-finish-line?ID=6604316&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-animal-slip-resistant-oil-resistant-non-marking-dress-comfort-slip-on-loafer?ID=7480816&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:56:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-telegraph-s.u.p.r.o.-sock-leather-cap-toe-dress-casual-comfort-oxford?ID=7479795&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:56:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-i-5923-runner-casual-sneakers-from-finish-line?ID=6976736&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-fund-classic-dress-comfort-penny-moc-loafer?ID=7479781&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:56:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-mens-swift-run-casual-sneakers-from-finish-line?ID=6656427&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/timberland-mens-6-premium-waterproof-boot?ID=2725209&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/deer-stags-mens-tribune-s.u.p.r.o.-sock-leather-wingtip-dress-casual-comfort-oxford?ID=7479797&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:56:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/teva-mens-omnium-2-sandals?ID=7080676&CategoryID=55822> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-sportswear-rally-relaxed-fleece-pants?ID=5780171&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-garcelle-printed-crop-top?ID=8247093&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:56:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-marabelle-lace-dress?ID=8100386&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:56:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-x-j-balvin-vibras-printed-thong-bodysuit?ID=8157999&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:56:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-cotton-camo-print-dress?ID=7458102&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:56:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-high-waist-bikini-bottoms?ID=6685381&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-two-tone-ruched-dress?ID=7018679&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-explosive-printed-leggings?ID=6374969&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-organic-cotton-message-t-shirt?ID=8600651&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:56:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-the-studded-icon-cotton-raw-hem-jeans?ID=7091215&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:56:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-tayla-ruched-maxi-dress?ID=8600624&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:56:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-high-rise-skinny-jeans?ID=8061058&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:56:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-cotton-colorblocked-utility-shirt-created-for-macys?ID=7607200&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-logo-ring-bikini-bottoms?ID=7135380&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-roll-cuff-sleepshirt?ID=2826523&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:56:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-printed-jersey-bell-sleeve-a-line-dress?ID=8975820&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-laurena-floral-print-keyhole-romper?ID=7213595&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:56:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-cotton-studded-denim-skirt?ID=7091209&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 11:56:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-yanni-cutout-ruched-sleeve-top?ID=7483599&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-printed-wrap-dress?ID=8100378&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:56:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-straight-stretch-pants?ID=6913627&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-lola-chain-embellished-tank-top?ID=8600634&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:56:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-velvet-illusion-a-line-dress?ID=6797554&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-draped-open-front-cardigan-sweater?ID=6829442&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Sweaters', '', '']
2019-04-28 11:56:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-greta-ruched-mini-dress?ID=8403655&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:56:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-logo-embroidery-short-sleeve-pajama-top?ID=8266729&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:56:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-rib-knit-tie-front-bodycon-dress?ID=8204901&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:56:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-cotton-t-shirt?ID=8329982&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:56:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-woven-cotton-notch-collar-top-capri-pajama-set?ID=8896288&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:56:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-sleepshirt?ID=7368104&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:56:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-tatiana-graphic-sweatshirt?ID=8100478&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:56:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-woven-sleepshirt?ID=8266720&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:56:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-invisibles-hipster-3-pack-qd3559?ID=2435993&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:57:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-rylee-sheer-sleeve-tie-hem-top?ID=8600590&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:57:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-colorblocked-cotton-skirt?ID=8043812&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-contrast-trimmed-printed-satin-pajama-set?ID=7368195&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:57:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-side-zipper-cutoff-shorts?ID=8061190&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:57:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-lexie-ruffled-faux-leather-skirt?ID=7109920&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 11:57:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-printed-varsity-stripe-jogger-pants?ID=7458099&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Leggings & Pants', '', '']
2019-04-28 11:57:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-teeya-metallic-moto-jacket?ID=7109963&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 11:57:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-flutter-sleeve-flounce-dress?ID=7110850&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-danna-off-the-shoulder-crop-top?ID=8247122&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:57:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-junia-floral-print-wrap-dress?ID=8100476&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:57:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-bella-romper?ID=8247082&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:57:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-taya-sheer-peasant-top?ID=8247089&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:57:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-cyon-illusion-lace-contrast-bodysuit?ID=7213628&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:57:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-terry-mixed-print-wide-leg-pants?ID=8395226&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Leggings & Pants', '', '']
2019-04-28 11:57:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-claudia-side-zipper-cutoff-shorts?ID=8594422&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:57:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-split-v-neck-sleeveless-woven-blouse?ID=7950298&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-short-sleeve-top-pajama-pants-set?ID=8060728&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:57:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-jadie-smocked-crop-top?ID=8247094&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:57:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-ronda-distressed-denim-shorts?ID=8403651&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:57:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-v-neck-cotton-cricket-sweater?ID=8040154&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-vella-printed-off-the-shoulder-dress?ID=8100375&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:57:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-bandana-logo-print-t-shirt?ID=8247101&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:57:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-short-sleeve-maria-top?ID=8100467&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:57:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-plus-size-chain-lace-up-top?ID=7603918&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-tula-drape-front-belted-jacket?ID=8100403&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 11:57:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-valeria-lace-catsuit?ID=7213589&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-x-j-balvin-vibras-zippered-sleeve-graphic-jacket?ID=8158003&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 11:57:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-emiliane-crisscross-off-the-shoulder-top?ID=7483614&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Sweaters', '', '']
2019-04-28 11:57:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-button-front-top-pants-pajama-set?ID=2699369&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:57:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-the-push-up-high-rise-skinny-jeans?ID=8046737&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:57:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-trixie-shirred-ruffled-skirt?ID=8247077&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 11:57:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-womens-invisibles-floral-embroidery-lace-bra?ID=6143778&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:57:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-cap-sleeve-bandage-sweater-dress?ID=7213661&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:57:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-x-j-balvin-vibras-cotton-graphic-cropped-t-shirt?ID=8157996&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:57:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-riley-frayed-denim-shorts?ID=8478264&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:57:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-hooded-belted-coat?ID=6437137&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-womens-statement-1981-wire-free-padded-bralette-qf5177?ID=8067329&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:57:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-amy-printed-off-the-shoulder-bodysuit?ID=7215138&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:57:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-banica-zip-up-ribbed-top?ID=8100461&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Sweaters', '', '']
2019-04-28 11:57:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-banded-metallic-dress?ID=7084290&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-form-thong-3-pk-qd3710?ID=8386507&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:57:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-stunner-flare-leg-jeans?ID=8061259&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:57:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-sportswear-metallic-logo-cropped-sweatshirt?ID=6272287&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-long-open-front-cardigan?ID=8330326&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-bell-sleeve-ponte-knit-dress?ID=7342826&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-floral-print-bell-sleeve-blouse?ID=7989889&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-low-rise-distressed-skinny-jeans?ID=5485837&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:57:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-pauline-lace-up-romper?ID=8100340&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:57:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-stand-collar-cat-motif-sweater?ID=7110006&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Sweaters', '', '']
2019-04-28 11:57:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-cotton-ripped-hooded-denim-jacket?ID=7091207&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 11:57:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-originals-adicolor-sweatshirt?ID=5929592&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-pom-pom-fleece-slipper-socks?ID=5051291&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:57:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-christabel-tie-front-cardigan-sweater?ID=8100462&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Sweaters', '', '']
2019-04-28 11:57:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-dema-lace-up-trim-faux-leather-shorts?ID=8100347&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:57:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-ruched-dress?ID=7018617&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-riley-frayed-denim-shorts?ID=8247085&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:57:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-abbot-hooded-denim-jacket?ID=8060823&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 11:57:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-off-the-shoulder-pleated-bodysuit?ID=6303975&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:57:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-quilted-shawl-collar-short-robe?ID=2102465&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:57:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-lace-trim-striped-knit-nightgown?ID=8455254&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:57:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-twill-shirtdress?ID=8330359&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-new-1981-flare-leg-jeans?ID=8403813&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:57:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-faux-fur-hooded-sweatshirt-created-for-macys?ID=6979825&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-power-low-rise-skinny-jeans?ID=5471441&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:57:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-averill-sequined-mesh-dress?ID=7213606&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:57:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-bandage-bodycon-dress?ID=8100390&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:57:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-cotton-the-icon-studded-ripped-jeans?ID=7091220&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:57:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-chevron-1981-skinny-jeans?ID=7213582&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:58:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-vera-floral-print-belt-detail-dress?ID=8100474&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:58:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-ripped-ankle-jeans?ID=8046747&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:58:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-haidee-bell-sleeve-wrap-top?ID=7213604&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-asymmetrical-sherpa-lined-jacket?ID=7109992&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 11:58:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-venetia-metallic-peplum-top?ID=8600648&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-printed-sweatshirt-created-for-macys?ID=7214594&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-denim-contrast-shirtdress?ID=7224068&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:58:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-sleepshirt?ID=7368107&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-iris-peplum-faux-leather-jacket?ID=8100409&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 11:58:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-premier-straight-jeans?ID=6834549&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 11:58:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-shenna-eyelet-top?ID=8247088&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-printed-cropped-t-shirt?ID=8247102&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-printed-tie-hem-t-shirt?ID=8247099&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-kason-lace-bodycon-dress?ID=8247117&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:58:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-x-j-balvin-vibras-cropped-tank-top?ID=8157998&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-clover-print-blouson-top-in-regular-petite-sizes?ID=7902409&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-seamless-bikini-3-pack-qd3564?ID=2435994&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-kairi-metallic-striped-shorts?ID=8247083&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:58:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-colorblocked-fit-flare-dress?ID=7019201&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sexy-curve-ripped-cropped-jeans?ID=7660066&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:58:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-printed-off-the-shoulder-dress-created-for-macys?ID=7368146&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-petite-bell-sleeve-metallic-knit-dress?ID=7111383&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-form-push-up-plunge-bra-qf4200?ID=6672449&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-performance-plus-size-honeycomb-mesh-jacket-leggings?ID=6351735&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:58:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-originals-3-4-sleeve-striped-mock-neck-top?ID=7213312&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-antoinette-striped-sweater-dress?ID=8100473&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:58:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-non-iron-stretch-sleeveless-shirt?ID=6170705&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-printed-button-front-shirt?ID=7213652&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-contrast-trim-dress?ID=6436309&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-trixie-off-the-shoulder-crop-top?ID=8247092&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-alison-ribbed-zipper-front-dress?ID=8100385&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:58:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-invisibles-comfort-lightly-lined-retro-bralette-qf4783?ID=6672453&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-roll-cuff-sleepshirt?ID=839762&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-koko-asymmetrical-skort?ID=6045527&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:58:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-leda-cotton-embellished-denim-jacket?ID=7483613&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 11:58:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sandy-lace-inset-jumpsuit?ID=7483578&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Leggings & Pants', '', '']
2019-04-28 11:58:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sandra-belted-faux-leather-jumpsuit?ID=7213596&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Leggings & Pants', '', '']
2019-04-28 11:58:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-lightly-lined-plunge-bra-qf4828?ID=6750339&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-womens-unlined-reversible-bralette-qf5233?ID=8386547&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-border-print-satin-wrap-robe?ID=7368193&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-melissa-faux-leather-bomber-jacket?ID=7215137&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 11:58:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-fit-flare-dress?ID=6711180&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-cotton-shirt?ID=8043879&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-busy-guessing-long-sleeve-t-shirt?ID=7109982&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-rainbow-sequin-maxi-dress?ID=7215036&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:58:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-long-sleeve-knit-cotton-robe?ID=8060724&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['', '', '', '']
2019-04-28 11:58:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sandra-lace-trim-romper?ID=8403653&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Leggings & Pants', '', '']
2019-04-28 11:58:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-multi-color-striped-pull-on-skirt-created-for-macys?ID=7368165&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-nicolina-thong-bodysuit?ID=8100422&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-molly-tulip-sleeve-bodycon-dress?ID=5496738&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:58:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sleeveless-tilla-dress?ID=8600626&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:58:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-bella-sleeveless-denim-romper?ID=8247081&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:58:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-dawn-logo-graphic-printed-bodysuit?ID=8600606&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-womens-logo-mesh-detail-triangle-bralette-r70t107?ID=7801159&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-kaycee-printed-ruffled-top?ID=7213601&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-cotton-logo-t-shirt?ID=8100368&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sleeveless-crochet-trim-fit-flare-dress?ID=8100389&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:58:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-printed-sleepshirt?ID=7368114&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-elysian-faux-wrap-maxi-dress?ID=7109942&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-cotton-nightgown?ID=7368111&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-lucia-studded-corset-dress?ID=7213663&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:58:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-statement-1981-logo-reversible-bralette-qf5176?ID=8067328&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-bianca-embroidered-sexy-curve-jeans?ID=7213586&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:58:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-flower-print-3-4-sleeve-woven-sleepshirt?ID=8266726&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-notch-collar-printed-sleepshirt?ID=7660545&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-keyhole-stretch-dress?ID=7877603&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-retro-logo-stripe-lightly-lined-bralette-qf5202?ID=8807797&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-womens-embroidered-pom-pom-lace-thong-qf5190?ID=8807795&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-glitter-logo-t-shirt?ID=7109979&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-colorblock-cotton-zip-up-top?ID=8056971&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-yulia-sheer-lace-top?ID=8100425&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-long-sleeve-polina-ribbed-top?ID=8100444&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-floral-printed-belted-halter-midi-dress?ID=7654605&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-bria-denim-jumpsuit?ID=8100332&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:58:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-contrast-trim-textured-jacket?ID=7989882&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-striped-cotton-shirtdress?ID=8330472&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-ali-lace-up-sweater?ID=8100463&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Sweaters', '', '']
2019-04-28 11:58:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-plus-size-illusion-back-fit-flare-dress?ID=6891205&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-printed-cotton-notch-collar-pajama-set?ID=7368118&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/spanx-undie-tectable-bandeau-bra-30031r?ID=6583993&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:58:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sabrina-lace-up-bodysuit?ID=7660005&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:58:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-petite-wide-leg-cropped-pants?ID=9382421&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:58:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-printed-surplice-bell-sleeve-top?ID=7213602&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-oversized-ripped-denim-trucker-jacket?ID=6709877&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 11:59:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-raw-hem-ankle-skinny-jeans?ID=5455859&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:59:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-studded-cotton-denim-skirt?ID=7101528&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 11:59:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-originals-striped-long-sleeve-t-shirt?ID=7483584&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-silvana-lace-mini-dress?ID=6278872&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:59:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-curvy-skinny-jeans?ID=6984080&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:59:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-womens-unlined-triangle-bra-qf4984?ID=6723289&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-woven-pajama-set?ID=7660553&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mock-neck-elbow-sleeve-top?ID=7109983&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-nadine-embellished-lace-trim-dress?ID=7213659&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:59:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-graphic-t-shirt-dress?ID=8100373&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:59:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-split-sleeve-belted-romper?ID=8100338&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:59:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-kaye-ruffled-off-the-shoulder-top?ID=8247127&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-lisse-printed-flared-sleeve-blouse?ID=7483581&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-shirt-skinny-pants?ID=9019340&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:59:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-kinzie-animal-print-mini-dress?ID=7109949&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:59:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-boyfriend-sleepshirt?ID=2826524&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-glitter-triangle-logo-t-shirt?ID=7483598&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-print-logo-woven-cotton-long-ballet-sleepshirt?ID=8060716&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-embellished-printed-t-shirt?ID=8600602&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-cotton-notch-collar-top-capri-pajama-pants-set?ID=8896273&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-jersey-shift-dress?ID=7018530&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:59:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-printed-notch-collar-top-capri-pajama-pants-set?ID=8455263&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-delia-cotton-eyelet-top?ID=8600650&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-x-j-balvin-vibras-printed-graphic-bandeau-top?ID=8157997&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-jessa-twist-front-cropped-top?ID=8247098&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-susan-cotton-eyelet-skirt?ID=8669712&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 11:59:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-short-sleeve-contrast-bling-logo-t-shirt?ID=7213637&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-montrese-off-the-shoulder-lace-sleeve-romper?ID=7483579&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:59:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-plus-size-belted-jumpsuit?ID=6891182&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:59:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-textured-sheath-dress?ID=2816906&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:59:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-millea-sleeveless-tie-front-dress?ID=8247116&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:59:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-knit-notch-collar-top-capri-pajama-pants-set?ID=8266734&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-floral-print-fit-flare-dress?ID=7019243&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:59:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-jamison-belted-sequined-romper?ID=7213592&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:59:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-form-lightly-lined-demi-bra-qf4081?ID=6672448&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-half-sleeve-celina-top?ID=8600640&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-womens-monogram-mesh-unlined-bralette-qf5206?ID=8386510&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sleeveless-printed-surplice-neck-cropped-top?ID=8600592&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-boat-neck-top?ID=8043827&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:59:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-ripped-ankle-jeans?ID=8046763&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 11:59:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-logo-graphic-t-shirt?ID=8100371&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-floral-romper?ID=8100352&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:59:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mabel-cropped-butterfly-sleeve-top?ID=8247133&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-striped-graphic-bodysuit?ID=8600544&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-destroy-bodycon-denim-skirt?ID=8434436&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 11:59:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-designed2move-climalite-leggings?ID=4988890&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:59:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mairin-printed-one-shoulder-top?ID=8600635&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-plus-size-logo-tape-top-leggings?ID=7936030&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 11:59:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-chloe-cold-shoulder-tie-neck-blouse?ID=8100361&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-gabri-printed-sleepshirt-fleece-socks-set?ID=6747988&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-woven-notch-collar-top-capri-pajama-pants-set?ID=8266731&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-jaziel-cutout-zip-detail-jumpsuit?ID=8100342&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Leggings & Pants', '', '']
2019-04-28 11:59:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-jennifer-sequined-shift-dress?ID=7213616&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:59:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-plus-size-astrid-poncho-pajama-top?ID=7040172&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sara-ruffled-jumpsuit?ID=8393292&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:59:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-womens-pom-pom-lace-unlined-triangle-bralette-qf5186?ID=8807794&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-kiersten-off-the-shoulder-keyhole-bodysuit?ID=8100459&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-cotton-lace-up-shorts?ID=8348790&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:59:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-knit-cotton-notch-collar-top-capri-pajama-pants-set?ID=8455261&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-floral-print-cotton-shirt?ID=8330367&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:59:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-lace-sleeve-jersey-dress?ID=7018500&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:59:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-pro-printed-cropped-leggings?ID=5781092&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:59:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-deco-denim-bodycon-dress?ID=7483586&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:59:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-short-sleeve-sweater?ID=7483814&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 11:59:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-hybrid-1981-jean-shorts?ID=8600557&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:59:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-long-sleeve-porsha-top?ID=8100419&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-camila-floral-print-faux-wrap-dress?ID=7213608&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 11:59:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-floral-print-long-sleeve-top?ID=8600594&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 11:59:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-womens-logo-sporty-bralette-r79t011?ID=7334961&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-1981-ripped-jean-shorts?ID=8600556&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 11:59:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-woven-top-boxer-pajama-shorts-set?ID=8266722&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 11:59:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-crystal-belt-jumpsuit?ID=7019215&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-printed-cold-shoulder-ruched-top?ID=8600588&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/8637857michael-michael-kors-plus-size-printed-off-the-shoulder-top-mosaic-print-tiered-skirt?ID=8761881&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:00:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-adaptive-womens-ronnie-indigo-top-with-magnetic-closures?ID=8435805&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-ruffled-printed-knit-nightgown?ID=7660539&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-metallic-ponte-knit-shift-dress?ID=7018496&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-power-low-rise-skinny-jeans?ID=6667748&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:00:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-striped-short-sleeve-sweater?ID=7483805&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenall-kylie-button-fly-cutoff-shorts?ID=8060899&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:00:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-lace-trim-cutout-sweatshirt?ID=7213642&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-pleated-neck-tie-top?ID=8042409&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sheryll-lace-top?ID=7660014&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-cellesta-lace-keyhole-dress?ID=7483592&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:00:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-military-inspired-officer-jacket?ID=8042398&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-spotted-floral-lace-plunge-push-up-bra-qf5220?ID=8807714&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-flower-garden-logo-print-t-shirt?ID=8247100&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-astrid-pajama-poncho?ID=7039956&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/spanx-womens-plus-size-oncore-high-waisted-mid-thigh-short-ps1915?ID=4920982&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-cotton-skirt?ID=8329984&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-vyolet-faux-leather-zip-front-romper?ID=8100349&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:00:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-bijou-tonal-wrap-dress?ID=7213614&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:00:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-micro-floral-off-the-shoulder-top?ID=7902404&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-casandra-off-the-shoulder-lace-crop-top?ID=8600630&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-julie-eyelet-yoke-top?ID=8100479&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Sweaters', '', '']
2019-04-28 12:00:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-scoop-back-bralette-qf5490?ID=6656073&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-studded-overalls-bustier?ID=8100355&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-plus-size-camo-print-sweater-skirt?ID=8171204&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:00:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-islynn-ruched-bodycon-dress?ID=8100377&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:00:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-ripped-ankle-jeans?ID=8046757&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:00:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-originals-cotton-cropped-tank-top?ID=8569984&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-glitter-logo-crewneck-t-shirt?ID=8600601&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-border-print-satin-chemise-nightgown?ID=7368191&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-lace-sheer-trim-cold-shoulder-top?ID=8247123&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-juniors-original-bodysuit?ID=8100477&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-tarra-rebel-faux-leather-moto-jacket?ID=8100417&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 12:00:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-lightly-lined-bralette-qf5650?ID=8386503&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-logo-embroidered-drapey-caftan?ID=8266728&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-aldridge-mini-striped-knit-wrap-robe?ID=7371065&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-knit-cotton-nightgown?ID=8455248&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sleeveless-gamilla-lace-top?ID=8247121&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-lisette-lace-dress?ID=7483589&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:00:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-floral-printed-bell-sleeve-sheath-dress?ID=7203786&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-lace-triangle-bralette-qf5083?ID=8083321&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-womens-bandeau-strapless-logo-bralette-r70t082?ID=7214090&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-zaylee-high-low-belted-shirtdress?ID=8247113&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:00:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-monogram-unlined-triangle-bra-qf4919-first-at-macys?ID=6132138&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-ripped-denim-trucker-jacket?ID=8046692&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 12:00:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-charissa-wide-leg-pants?ID=8600554&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Leggings & Pants', '', '']
2019-04-28 12:00:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-larisa-lace-bodysuit?ID=7483601&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-boxer-pajama-set?ID=7660533&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-studded-1981-skinny-jeans?ID=8100333&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:00:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-originals-iconic-triangle-logo-striped-top?ID=7483583&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-camilla-choker-neck-sheer-sleeve-bodysuit?ID=7213600&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-denim-snap-closure-shirt?ID=8100363&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-lace-up-1981-skinny-jeans?ID=7213583&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:00:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-cropped-flounce-hem-jeans?ID=7902497&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-asymmetrical-neck-bodycon-dress?ID=6076835&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:00:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-trixie-off-the-shoulder-crop-top?ID=8247091&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-heathered-floral-scuba-dress?ID=7654612&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-embellished-logo-t-shirt?ID=5221544&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-lightweight-striped-cotton-pants?ID=8042402&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-puff-sleeve-cotton-top?ID=8040171&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-denim-cotton-shift-dress?ID=8043854&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-niki-mesh-mock-neck-top?ID=7213792&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-jenny-gilded-printed-dress?ID=7910631&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:00:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-tarra-faux-leather-denim-contrast-mini-skirt?ID=8100351&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:00:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-invisibles-thong-3-pack-qd3558?ID=2435992&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-fleece-transitional-pants?ID=8899037&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-floral-print-skinny-jeans-in-regular-petite-sizes?ID=7484079&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:00:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-bingham-bermuda-printed-cotton-pajama-set?ID=5486549&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-cotton-cropped-embossed-hoodie?ID=8348788&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:00:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-the-ultra-babe-cropped-jeans?ID=7091224&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:00:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-stripe-print-short-sleeve-top-capri-pajama-pants-set?ID=8060732&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-logo-embroidery-flounce-nightgown?ID=8266725&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-satin-pajama-set?ID=7368198&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:00:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-x-j-balvin-claudia-colorblocked-shorts?ID=8157993&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:00:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-the-icon-jean-retro-inspired-relaxed-slim-boyfriend-jean?ID=6709882&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:01:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-woven-sleepshirt?ID=8266721&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-striped-cotton-top?ID=8043810&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-printed-faux-wrap-dress?ID=7520602&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-paisley-print-top?ID=8520188&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-1981-cuffed-skinny-jeans?ID=8100334&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:01:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mansfield-lace-mock-neck-top?ID=7109985&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:01:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-striped-tie-front-shirt-created-for-macys?ID=7214631&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-lyndi-satin-peplum-top?ID=7483580&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:01:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-larkin-ribbed-cutout-bodycon-dress?ID=7483588&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:01:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-velvet-open-front-shrug?ID=5363214&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-cotton-striped-tie-sleeve-split-neckline-top-created-for-macys?ID=7376375&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-prism-surplice-top?ID=7213645&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:01:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-denim-trucker-jacket?ID=6039135&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 12:01:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-womens-logo-v-neck-bralette-r70t040?ID=7214131&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-zippered-side-frayed-hem-skirt?ID=8061060&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:01:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-skylee-crop-top?ID=8247096&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:01:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-cotton-cutout-back-shirt?ID=7458097&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:01:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-womens-logo-seamless-racerback-triangle-bralette-r70t106?ID=7801158&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-bingham-bermuda-plus-size-printed-cotton-pajama-set?ID=5486552&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-bella-tie-hem-blouse?ID=8100357&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:01:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-womens-lightly-lined-wireless-bralette-qf5232?ID=8386511&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-penny-solid-fleece-pajama-pants?ID=8279848&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-ria-lace-ruched-dress?ID=7214895&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:01:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-zippered-cuffed-romper?ID=8600564&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:01:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-scarf-print-shirt?ID=7902398&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-trixie-smocked-pull-on-skirt?ID=8247076&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:01:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-pique-blazer?ID=8331135&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-vivian-knit-sleepshirt?ID=7371062&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-notch-collar-printed-knit-sleepshirt?ID=7660549&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-cotton-ribbed-crop-top?ID=8447407&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:01:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-lace-up-t-shirt-in-regular-petite-sizes?ID=7812086&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mae-flirty-faux-leather-jacket?ID=7213623&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 12:01:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-drew-cuffed-denim-shorts?ID=7659995&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:01:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-tissa-printed-ruched-bodycon-dress?ID=8100387&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:01:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-windowpane-check-sleeveless-blouse?ID=7989891&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sexy-curve-cropped-jeans?ID=7660057&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:01:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-kellyanne-floral-print-high-low-dress?ID=8100376&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:01:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-faux-wrap-o-ring-top-in-regular-petite-sizes?ID=9360449&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-polo-bear-cotton-t-shirt?ID=8305335&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-womens-perfectly-fit-geometric-lace-plunge-bra-qf5065?ID=8083346&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-tiffany-lace-crop-top?ID=8600646&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:01:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-ribbed-lace-up-dress?ID=8100384&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:01:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-rivieria-metallic-ruched-romper?ID=7109930&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:01:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-the-push-up-high-rise-skinny-jeans?ID=8046741&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:01:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-zipper-detail-sheath-dress?ID=7520621&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mairin-printed-ruffled-skirt?ID=8600586&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:01:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-nya-pajama-set?ID=6614779&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-plunging-ruffled-dress?ID=8100392&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:01:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-hydro-rash-guard?ID=5132410&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-francesca-cat-print-cropped-top?ID=8348786&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:01:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-printed-reversible-zip-dress?ID=8100398&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:01:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-knit-pajama-set?ID=7660583&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-petite-embellished-sheath-dress?ID=8776475&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-stunner-stunner-released-hem-flared-jeans?ID=8061260&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:01:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-juni-printed-tie-front-shorts?ID=8600560&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:01:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-colorblocked-shirtdress?ID=6522715&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:01:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-navi-lace-mini-skirt?ID=8100344&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:01:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-kae-printed-velvet-ruched-dress?ID=7213610&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:01:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-keelin-striped-tie-front-blouse?ID=8100353&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:01:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-notch-collar-pajama-set?ID=7368109&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-satin-top-pajama-pants-set?ID=8060730&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sleeveless-tawni-top?ID=8600639&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:01:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-half-sleeve-super-crop-emma-top?ID=8600632&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:01:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-cotton-3-4-sleeve-top-pajama-pants-set?ID=8060729&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-belted-short-fleece-robe?ID=6749726&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:01:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-holly-ribbed-lace-up-sweater?ID=7483606&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Sweaters', '', '']
2019-04-28 12:01:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-printed-off-the-shoulder-top?ID=7458098&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-satin-trim-midi-fit-flare-dress?ID=7018585&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-latrice-printed-surplice-dress?ID=7483587&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:02:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-band-topper-jacket-created-for-macys?ID=7376351&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-icon-side-zipper-cutoff-shorts?ID=8061189&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:02:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-angled-jogger-pants?ID=8348791&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Leggings & Pants', '', '']
2019-04-28 12:02:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sariyah-lace-bodysuit?ID=8247125&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-desert-land-cotton-logo-graphic-t-shirt?ID=8247128&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-cotton-eyelet-cold-shoulder-top?ID=8520747&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-riyah-lace-bralette?ID=8247129&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-the-ultra-babe-skinny-jeans?ID=7091211&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:02:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-embroidered-jogger-pants?ID=8040145&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-white-stripe-distressed-jean-skirt?ID=8061036&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:02:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-printed-cotton-sleepshirt?ID=7368113&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:02:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-off-the-shoulder-lace-top?ID=8100424&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-contrast-striped-sweatpants?ID=8331136&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-x-j-balvin-vibras-cotton-tie-dyed-cutoff-shorts?ID=8158002&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:02:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-lace-up-eyelet-stitch-sweater?ID=8247131&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Sweaters', '', '']
2019-04-28 12:02:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-ruffled-faux-wrap-dress?ID=5379774&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-ripped-frayed-hem-skirt?ID=8060959&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:02:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-allison-cutout-sweater-dress?ID=8204899&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:02:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mirage-cutout-bandage-dress?ID=7483593&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:02:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-brelee-lace-illusion-bodycon-dress?ID=8100383&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:02:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-printed-cold-shoulder-peasant-top?ID=7484016&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-frayed-hem-bermuda-shorts?ID=8061187&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:02:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-luma-lace-thong-bodysuit?ID=8600637&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/fila-logo-bodycon-dress?ID=5882461&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-valorie-strappy-bodycon-dress?ID=8247107&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:02:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-jacquard-fit-flare-dress?ID=7019239&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-black-label-womens-fan-floral-lace-thong-qf5228?ID=8083379&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:02:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-smocked-tulip-shorts?ID=8600548&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:02:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-three-quarter-sleeve-printed-cotton-sleepshirt?ID=1987406&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:02:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-plus-size-gym-vintage-collection?ID=6131597&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:02:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-non-iron-straight-fit-shirt?ID=5333354&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-plus-size-printed-bell-sleeve-top?ID=7917957&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-goldie-double-knit-leggings?ID=6614780&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:02:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-long-sleeve-velour-bodycon-dress?ID=7109959&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-icon-studded-cutoff-shorts?ID=8061261&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:02:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nine-west-peplum-fringe-flyaway-blazer?ID=6720154&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-plus-size-printed-ruffled-shift-dress?ID=7917969&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-stripe-trimmed-wrap-robe?ID=7368108&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:02:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-tie-dye-graphic-t-shirt?ID=8600605&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-floral-print-georgette-skirt?ID=8040129&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-paisley-print-3-4-sleeve-sleepshirt?ID=8060722&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:02:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-ruched-dress?ID=8401681&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-floral-print-midi-dress?ID=7018607&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-printed-knit-pajama-set?ID=7660579&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:02:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-floral-print-sweater-in-regular-petite-sizes?ID=7484025&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-textured-bandage-dress?ID=8100382&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:02:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-dorthy-printed-off-the-shoulder-top?ID=5612095&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-liesa-off-the-shoulder-flounce-top?ID=8600641&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-x-j-balvin-vibras-graphic-print-mesh-bodysuit?ID=8158001&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-paxton-biker-shorts?ID=8403669&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-chain-lace-up-top?ID=6991508&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-zeena-cutout-mock-neck-top?ID=8600636&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-graphic-cold-shoulder-t-shirt?ID=8600607&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-pique-blazer?ID=8329993&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-embossed-button-vest?ID=8285784&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-grace-floral-print-skirt?ID=8100466&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:02:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-jumpsuit?ID=8040066&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-do-all-studded-cuffed-shorts-overalls?ID=8061266&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:02:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-palm-tree-graphic-bodysuit?ID=8600603&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-striped-belted-top-created-for-macys?ID=7376377&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-monogram-unlined-bralette-qf4918-first-at-macys?ID=6132137&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:02:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-skylee-printed-pleated-shorts?ID=8247080&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:02:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-button-front-overall-shorts?ID=8060825&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:02:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-taila-lace-ruffled-dress?ID=7213612&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:02:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-zaylee-striped-high-low-shirtdress?ID=8247109&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:02:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-isotta-cotton-eyelet-top?ID=8600643&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-donna-printed-surplice-neck-blouse?ID=8100364&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-destructed-denim-bermuda-shorts?ID=5528880&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:02:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-off-the-shoulder-mirage-lace-up-top?ID=8100464&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sleeveless-smocked-peplum-top?ID=8600596&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-striped-shirt-tattersall-skinny-pants?ID=9019290&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:02:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-1981-cutoff-shorts?ID=8600558&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:02:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-cotton-3-4-sleeve-top-pajama-pants-set?ID=8060734&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:02:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-tallulah-sleeveless-lace-trim-top?ID=8100360&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-fallon-pajama-set?ID=6784936&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:02:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-essential-linear-logo-pants?ID=2957331&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:02:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-soleil-twist-front-cropped-top?ID=8247130&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-printed-jersey-knit-notch-collar-top-capri-pajama-pants-set?ID=8266733&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:02:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sleeveless-shandra-bodysuit?ID=8100420&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:02:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-side-striped-sweatpants?ID=8040186&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-ripped-denim-skirt?ID=8060916&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:03:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-cold-shoulder-lace-top?ID=8600599&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-lightly-lined-constant-strapless-bra-qf5528?ID=8083413&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:03:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-ripped-cutoff-shorts?ID=8060889&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:03:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-logo-graphic-t-shirt?ID=8600604&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-solid-turtleneck-sweater?ID=7134133&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-flounce-trim-printed-skirt-in-regular-petite-sizes?ID=7484031&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-marie-long-sleeve-sweater?ID=8348787&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Sweaters', '', '']
2019-04-28 12:03:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-allison-amory-cutout-sweater-dress?ID=7483595&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:03:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-organic-cotton-graphic-t-shirt?ID=8348789&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-ruffled-paisley-print-dress?ID=7902453&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-flutter-sleeve-satin-nightgown?ID=7368190&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:03:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sleeveless-graphic-print-top?ID=8600600&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-plus-size-printed-flutter-sleeve-top?ID=7917953&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-palm-print-t-shirt?ID=8247104&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-graphic-t-shirt?ID=8348780&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-blanche-ii-double-knit-fleece-robe?ID=6747986&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['', '', '', '']
2019-04-28 12:03:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-cotton-camo-print-skirt?ID=7458100&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:03:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-cotton-sleepshirt?ID=7368106&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:03:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-embroidered-swiss-dot-top?ID=7213626&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-cotton-pajama-set?ID=7368110&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:03:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-knit-notch-collar-top-capri-pajama-pants-set?ID=8266732&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:03:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-logo-embroidery-short-caftan?ID=8266727&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['', '', '', '']
2019-04-28 12:03:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-metallic-graphic-print-t-shirt?ID=7213631&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-ripped-cropped-jeans?ID=8046790&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:03:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-adaptive-womens-pants-with-zippers-at-hem?ID=8435799&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-shawl-collar-robe?ID=2691604&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:03:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-believe-this-climalite-ankle-training-pants?ID=6757240&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-relaxed-fit-linen-shirt?ID=7901747&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-lace-up-mirage-skirt?ID=8100465&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:03:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-premier-straight-curvy-jeans?ID=6948452&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-plaid-piping-trim-blouse?ID=7989706&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-carolina-scoop-neck-crop-top?ID=8247126&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-embellished-trim-open-front-cardigan?ID=8713781&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-katrina-lace-illusion-dress?ID=5455858&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:03:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-jennifer-strapless-contrast-bustier?ID=7213636&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-radiant-cotton-bikini-3-pack-qd3589?ID=2708242&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:03:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-jessamine-ruched-open-back-dress?ID=8100381&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:03:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-seductive-comfort-with-lace-full-coverage-bra-qf1741?ID=2908634&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 12:03:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-cotton-the-ultra-babe-skinny-jeans?ID=7091216&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:03:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-pull-on-skinny-jeans?ID=6667758&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:03:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-cape-overlay-chiffon-dress?ID=7342734&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-slim-fit-long-sleeve-oxford-shirt?ID=1817756&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-floral-print-twist-neck-top?ID=8151789&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-the-roselyn-wide-leg-pants?ID=8100337&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Leggings & Pants', '', '']
2019-04-28 12:03:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-long-embellished-graphic-sweatshirt?ID=7213641&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-flounce-trim-a-line-dress?ID=8491049&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-savina-cold-shoulder-top?ID=8247097&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-denim-foldover-skirt?ID=8600587&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:03:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-snake-print-bell-sleeve-dress?ID=7902464&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:03:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sleeveless-gingham-cropped-top?ID=8600597&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-ripped-denim-bermuda-shorts?ID=8100341&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:03:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-originals-long-sleeve-striped-logo-bodysuit?ID=7213311&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sleeveless-strappy-back-bodycon-dress?ID=8600610&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:03:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-claudia-high-waist-jean-shorts?ID=5422945&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:03:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-krissy-zippered-mini-skirt?ID=8061262&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:03:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-printed-lace-up-camisole?ID=8600595&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:03:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-printed-off-the-shoulder-bodycon-dress?ID=8600611&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:04:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-printed-tiered-hem-dress-in-regular-petite-sizes?ID=7902454&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:04:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-rework-denim-skirt?ID=8247084&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:04:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-hooded-puffer-jacket-created-for-macys?ID=7062937&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:04:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-puffer-vest?ID=6380783&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:04:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-tanlee-off-the-shoulder-bodycon-dress?ID=8247114&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:04:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-corset-t-shirt?ID=8520748&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:04:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-cotton-frayed-hem-denim-jacket?ID=6709878&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:04:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-ultimate-slimming-premier-cropped-skinny-jeans?ID=4533168&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:04:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-woven-cotton-notch-collar-top-capri-pajama-pants-set?ID=8455258&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:04:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-makara-seamed-pencil-skirt?ID=8600584&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:04:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-lizel-striped-romper?ID=8247075&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:04:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-womens-satin-trim-lace-tanga-qf5084?ID=8083324&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:04:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-ripped-malibu-shores-graphic-t-shirt?ID=8600628&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:04:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-cotton-knit-pajama-set?ID=7078402&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:04:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-cutoff-bermuda-shorts?ID=8061188&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:04:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-lenon-knit-pajama-set?ID=7371059&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:04:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-cotton-top-bermuda-shorts-pajama-set?ID=8266724&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:04:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-studded-1981-skinny-jeans?ID=8100335&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:04:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-tie-neck-cotton-shirt?ID=8040132&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:04:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-velvet-graphic-t-shirt?ID=7213633&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:04:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-dawn-high-waist-gingham-shorts?ID=8600562&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:04:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-embellished-blouson-tankini-top?ID=7135387&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:04:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sadiyah-wrap-top?ID=8100362&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:04:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-stripe-print-short-sleeve-top-capri-pajama-pants-set?ID=8060735&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:04:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-bella-off-the-shoulder-bustier-top?ID=8100359&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:04:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-gorgeous-graphic-top?ID=8100469&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:04:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-crepe-shirtdress?ID=7277510&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:04:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mirage-bandage-bodycon-dress?ID=7213617&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:04:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-zelda-printed-cutout-top?ID=8100454&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:04:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-erynn-pleated-dress?ID=8100331&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:04:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-maxie-faux-leather-shorts?ID=7213591&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:04:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-ripped-cropped-jeans?ID=8046819&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:04:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-cowlneck-cold-shoulder-sweater?ID=7110005&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Sweaters', '', '']
2019-04-28 12:04:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-double-snap-animal-print-pants?ID=7109919&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Leggings & Pants', '', '']
2019-04-28 12:04:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-the-ultra-babe-perfect-mid-rise-released-hem-jeans?ID=6709700&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:04:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-yessica-sleeveless-printed-dress?ID=8100374&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:04:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-jiya-printed-ruffled-bell-sleeve-top?ID=8247095&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:04:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-5-pack-soft-stretch-thong-qd3652?ID=5428635&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:04:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-short-sleeve-shirt-boxer-pajama-shorts-set?ID=8060718&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:04:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-floral-print-bell-sleeve-dress?ID=7342705&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:04:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-gym-club-training-duffel-bag?ID=4462853&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 12:04:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-plus-size-moto-jacket-animal-print-top-miranda-pants?ID=7934649&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:04:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-tahara-lace-inset-bodycon-dress?ID=7213618&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:04:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-rip-repair-denim-shorts?ID=8247074&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:04:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-drawstring-pajama-pants?ID=8266730&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:04:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-flounce-sleeve-knit-nightgown?ID=8060719&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:04:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-charlotte-crisscross-neckline-top?ID=8100431&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:04:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-arica-logo-graphic-drawstring-waist-hoodie?ID=8100366&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:04:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-zooey-printed-off-the-shoulder-jumpsuit?ID=8100339&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:04:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-trista-cropped-bell-sleeve-top?ID=8600649&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:05:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-janessa-keyhole-mock-neck-dress?ID=8100379&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:05:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-knit-cotton-nightgown?ID=8455249&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:05:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-womens-perfectly-fit-geometric-lace-t-shirt-bra-qf5064?ID=8240507&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:05:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-leda-ripped-denim-jacket?ID=8403667&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 12:05:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-orbit-1981-skinny-jeans?ID=7483577&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:05:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-retro-logo-stripe-unlined-bralette-qf5201?ID=8807796&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:05:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-plus-size-modern-cotton-unlined-bralette-qf5116?ID=6010574&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:05:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-printed-lace-trim-button-front-top?ID=8600647&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:05:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-floral-print-cotton-shirt?ID=8330475&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-the-sultry-super-high-rise-retro-skinny-jeans?ID=6709702&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:05:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-colleen-embroidered-bodysuit?ID=8600631&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:05:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-lace-up-faux-leather-moto-jacket?ID=8100416&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 12:05:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/polo-ralph-lauren-cable-knit-cotton-sweater?ID=6386698&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-ambra-v-neck-eyelet-cropped-top?ID=8600645&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:05:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-juju-sequined-floral-print-dress?ID=7213607&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:05:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-knit-cotton-bermuda-shorts-pajama-set?ID=8455255&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:05:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-plus-size-signature-cotton-logo-thong-5-pk.-qf5120?ID=6010578&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:05:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-gabrielle-ruched-cutout-dress?ID=8600609&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:05:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-kior-high-waist-shorts?ID=8600659&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:05:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-tassel-hem-sheath-dress?ID=7367901&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-corset-detail-graphic-t-shirt?ID=8100372&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:05:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sleeveless-chambray-ruched-top?ID=8600589&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:05:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-rae-printed-bomber-jacket?ID=6829427&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 12:05:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-faux-pocket-shift-dress?ID=8874071&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-amelia-mini-striped-knit-pajama-set?ID=7371064&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:05:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-kain-printed-keyhole-top?ID=7213640&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:05:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-soffie-long-sleeve-lace-top?ID=7483602&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:05:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-originals-90s-colorblocked-track-pants?ID=6498774&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-edgy-frayed-hem-denim-jacket?ID=8060824&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 12:05:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-plus-size-gym-vintage-collection?ID=4988192&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:05:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-notch-collar-satin-pajama-set?ID=6739833&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-amelie-grommet-lace-up-sweater-dress?ID=7213667&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:05:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-print-logo-woven-cotton-long-ballet-sleepshirt?ID=8060717&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:05:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-scuba-sheath-dress-with-flutter-sleeves?ID=9002059&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-sequin-trim-jersey-dress?ID=4870313&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-saniya-printed-cold-shoulder-romper?ID=8600563&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:05:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-mairi-sleeveless-lattice-bodysuit?ID=8247124&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:05:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-savina-off-the-shoulder-lace-romper?ID=8247086&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:05:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-plus-size-layered-top-printed-leggings?ID=7935100&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:05:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-embellished-animal-print-t-shirt?ID=7109986&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:05:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-lace-polka-dot-jersey-dress?ID=7654609&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-elyza-cutaway-shoulder-top?ID=5455851&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:05:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-cropped-denim-jacket?ID=6038254&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jackets & Vests', '', '']
2019-04-28 12:05:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-greenwich-robe?ID=734764&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:05:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-sportswear-zip-hoodie?ID=6272486&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-farrah-ruffled-bodycon-dress?ID=8100380&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:05:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-off-the-shoulder-marabelle-top?ID=8100426&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:05:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-striped-jumpsuit?ID=8040131&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-flutter-sleeve-maxi-dress?ID=8285734&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-plus-size-peplum-hem-bell-sleeve-top?ID=7232491&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sheba-ruched-illusion-lace-dress?ID=8100388&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:05:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-printed-notch-collar-pajama-set?ID=7368116&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:05:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-off-the-shoulder-lace-bodycon-dress?ID=8600625&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:05:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-x-j-balvin-vibras-cotton-tie-dyed-cropped-hoodie?ID=8158000&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:05:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-lace-stripe-sheath-dress?ID=6890530&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nine-west-dark-floral-maxi-dress?ID=7117674&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:05:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-plus-size-printed-knit-nightgown?ID=8060725&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:05:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-reflective-sequin-graphic-t-shirt?ID=7483604&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:06:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-denim-bustier-top?ID=7213781&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:06:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-charissa-cutout-crop-top?ID=8600593&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:06:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-cropped-skinny-jeans?ID=7660034&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:06:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-straight-leg-ankle-pants?ID=7649268&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-ruffled-off-the-shoulder-cropped-top?ID=8600598&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:06:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-adaptive-womens-mercer-colorblock-top-with-magnetic-closures-at-shoulder?ID=8062269&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-3-4-sleeve-cotton-notch-collar-capri-pant-pajama-set?ID=1887909&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:06:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-notch-collar-knit-pajama-set?ID=7660575&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:06:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-satin-one-shoulder-dress?ID=7104632&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-andy-warhoal-bikini-qf5322?ID=8807806&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:06:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-icon-studded-cutoff-shorts?ID=8061265&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Shorts', '', '']
2019-04-28 12:06:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-knit-cotton-notch-collar-top-bermuda-shorts-pajama-set?ID=8455246&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:06:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-party-graphic-print-t-shirt?ID=7483611&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:06:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-glitter-sleeveless-open-back-bodycon-dress?ID=7213609&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:06:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-two-tone-jersey-dress?ID=6205107&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-plus-size-signature-cotton-logo-hipster-5-pk.-qf5119?ID=6010577&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:06:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-notch-collar-knit-pajama-set?ID=7660556&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:06:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-x-j-balvin-vibras-zippered-leg-sweatpants?ID=8158004&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Leggings & Pants', '', '']
2019-04-28 12:06:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-printed-pajama-set?ID=7660560&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:06:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-viola-lace-off-the-shoulder-top?ID=8600644&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:06:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-katrina-lace-up-bodysuit?ID=8100460&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:06:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-bianca-embroidered-mini-skirt?ID=7213598&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Skirts', '', '']
2019-04-28 12:06:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-floral-print-bell-sleeve-dress?ID=7018521&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-embellished-cotton-graphic-t-shirt?ID=7213657&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-womens-logo-shimmer-band-ribbed-triangle-bralette-r70t123?ID=7801160&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:06:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sexy-curve-ribbed-embellished-skinny-jeans?ID=7215035&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:06:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-the-sultry-high-rise-skinny-jeans?ID=8046699&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:06:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-crest-sweater?ID=7279339&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-joslyn-twisted-keyhole-bodycon-dress?ID=7109956&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Dresses', '', '']
2019-04-28 12:06:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-contrast-trimmed-printed-satin-wrap-robe?ID=7368192&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:06:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-belted-colorblocked-a-line-dress?ID=5315448&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nine-west-printed-inverted-pleat-top?ID=6988048&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kendall-kylie-the-vintage-icon-striped-jeans?ID=7091226&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Jeans', '', '']
2019-04-28 12:06:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-bikini-3-pack?ID=8386508&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:06:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-puff-sleeve-ribbed-top-created-for-macys?ID=7368133&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-wander-graphic-print-ripped-t-shirt?ID=8247103&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:06:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-leli-biker-zip-front-jumpsuit?ID=7214753&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-printed-pajama-set?ID=7660569&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-sydney-printed-notched-neck-top?ID=7483605&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Juniors', 'Tops', '', '']
2019-04-28 12:06:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-invisibles-comfort-lined-scoop-neck-bralette-qf4782?ID=6672452&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:06:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-5-pk.-cotton-blend-bikini-qp1094m?ID=4787881&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:06:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-petite-dark-wash-modern-straight-curvy-jeans?ID=6834550&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 12:06:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-spotted-floral-lace-thong-qf4863?ID=8807793&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Women', 'Bras, Panties & Lingerie', '', '']
2019-04-28 12:06:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-faux-double-breasted-blazer?ID=8285735&CategoryID=188851> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-fresh-foam-cruz-v2-decon-running-sneakers-from-finish-line?ID=7045262&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-free-run-2018-shield-running-sneakers-from-finish-line?ID=7262610&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/esprit-felice-memory-foam-wedge-booties?ID=7936052&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-womens-pacer-next-cage-casual-sneakers-from-finish-line?ID=6976868&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/the-north-face-womens-thermoball-water-resistant-button-up-boots?ID=6096917&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/alfani-womens-step-n-flex-kallumm-wide-calf-boots-created-for-macys?ID=6313456&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-gorun-mojo-reactivate-running-sneakers-from-finish-line?ID=6976810&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-i-5923-runner-casual-sneakers-from-finish-line?ID=6489840&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-247-v2-casual-sneakers-from-finish-line?ID=7079052&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-og-97-double-up-shiny-dancer-slip-on-casual-shoes-from-finish-line?ID=4574942&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:06:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/i.n.c.-kivah-two-piece-sandals-created-for-macys?ID=8594371&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 12:07:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-4-you-spirit-casual-walking-sneakers-from-finish-line?ID=7262485&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:07:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-flex-trainer-8-training-sneakers-from-finish-line?ID=6190453&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:07:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/naturalizer-nicole-pumps?ID=6885265&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:07:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-womens-hybrid-rocket-runner-casual-sneakers-from-finish-line?ID=6785028&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:07:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/anne-klein-essence-flat-sandals?ID=8515824&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:07:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-fresh-foam-cruz-v2-running-sneakers-from-finish-line?ID=6820488&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:07:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dr.-scholls-critic-wedge-booties?ID=6571100&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:07:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/seven-dials-reedy-lace-up-ankle-booties?ID=7598413&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:07:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/charter-club-microvelour-memory-foam-slippers-created-for-macys?ID=1424803&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:07:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-fast-exp-z07-casual-sneakers-from-finish-line?ID=7006812&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:07:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-womens-pacer-next-cage-casual-sneakers-from-finish-line?ID=7006814&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:07:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-relaxed-fit-breathe-easy-calmly-walking-sneakers-from-finish-line?ID=5886300&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:07:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/esprit-lena-block-heel-slide-sandals?ID=7080203&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:07:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/callisto-crosswalk-platform-wedge-sandals-created-for-macys?ID=6905045&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:08:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/reebok-womens-freestyle-high-top-casual-sneakers-from-finish-line?ID=6976872&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:08:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-womens-tishatsu-runner-knit-athletic-sneakers-from-finish-line?ID=6820582&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:08:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-air-max-1-casual-sneakers-from-finish-line?ID=8907603&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:08:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-flex-experience-run-7-running-sneakers-from-finish-line?ID=5395029&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:08:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-alphabounce-instinct-running-sneakers-from-finish-line?ID=7449723&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:08:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-flex-experience-run-7-running-sneakers-from-finish-line?ID=7336947&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:08:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/rialto-coline-pumps?ID=2997920&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 12:08:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/fila-womens-disruptor-athletic-sandals-from-finish-line?ID=8060533&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:08:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/white-mountain-fairfield-boots-created-for-macys?ID=8414525&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:08:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-flex-experience-run-7-wide-running-sneakers-from-finish-line?ID=6037982&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:09:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vlado-womens-skyla-slide-sandals-from-finish-line?ID=7722375&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:09:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/katy-perry-daina-booties?ID=8094009&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:09:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-revolution-4-running-sneakers-from-finish-line?ID=7604971&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:09:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-odyssey-react-running-sneakers-from-finish-line?ID=6453693&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:09:29 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vlado-womens-nova-casual-athletic-sneakers-from-finish-line?ID=6861388&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:09:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-madisen-riding-boots?ID=8286159&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:09:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-madison-casual-sneakers-from-finish-line?ID=7006189&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:09:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/fancy-feet-by-foot-petals-3-4-insoles-shoe-inserts?ID=2401853&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:09:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/asics-womens-gel-excite-4-running-sneakers-from-finish-line?ID=7006172&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:09:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/white-mountain-uptown-block-heel-slip-on-ankle-booties-created-for-macys?ID=6725310&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:09:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vince-camuto-breshan-espadrilles?ID=8234660&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:09:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/katy-perry-the-jimmi-pool-slides?ID=8531716&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:10:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-womens-muse-chase-casual-sneakers-from-finish-line?ID=7336950&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:10:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/carlos-by-carlos-santana-reagan-boots?ID=7079987&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:10:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/g-by-guess-oaker-slip-on-sneakers?ID=8979593&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:10:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-all-star-seasonal-high-top-casual-sneakers-from-finish-line?ID=7078572&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:10:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-relaxed-fit-bikers-zippiest-booties-from-finish-line?ID=7006235&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:10:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-on-the-go-600-monarch-athletic-sandals-from-finish-line?ID=6190334&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-revolution-4-running-sneakers-from-finish-line?ID=7145519&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lucky-brand-womens-riamsee-wedge-sandals?ID=5870052&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/isotoner-signature-tiffany-microsuede-low-boot-slippers?ID=6653432&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/style-co-womens-juliaa-slip-on-platform-wedge-sandals-created-for-macys?ID=4787992&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/naturalizer-simonette-mules?ID=5395800&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/patricia-nash-sabrina-perforated-ankle-booties?ID=8059612&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-womens-muse-eos-street-casual-athletic-sneakers-from-finish-line?ID=6976865&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-womens-defy-casual-sneakers-from-finish-line?ID=6489965&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/report-zerega-booties?ID=6868005&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/easy-street-nancy-wedges?ID=6307942&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-tanjun-casual-sneakers-from-finish-line?ID=3523506&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:11:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/jessica-simpson-averie-dress-sandals?ID=9337539&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-womens-birnbach-platform-wedge-sandals?ID=4855391&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-nmd-r1-stlt-primeknit-casual-sneakers-from-finish-line?ID=6820392&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:11:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/i.n.c.-floriann-block-heel-ankle-booties-created-for-macys?ID=5520150&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:12:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-fresh-foam-sport-running-sneakers-from-finish-line?ID=7449800&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:12:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/coach-jessie-buckle-thong-sandals?ID=7135567&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 116, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=child_sku_obj, parent_details=shared_product_details, category_list=macys_category_list, is_parent=False, is_variable=True))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 183, in gather_macys_variation
    selected_size = str(sku_obj['traits']['sizes']['selectedSize'])
KeyError: 'sizes'
2019-04-28 12:12:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/style-co-jerardy-wedge-ankle-booties-created-for-macys?ID=4789749&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:12:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-990-v4-running-sneakers-from-finish-line?ID=6820485&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:12:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-gowalk-lite-walking-sneakers-from-finish-line?ID=6293841&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:12:32 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/gentle-souls-by-kenneth-cole-womens-joy-platform-wedge-sandals?ID=4500390&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:12:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/roxy-portofino-ii-flip-flop-sandals?ID=9062143&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:12:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/thalia-sodi-rajel-wide-calf-dress-boots-created-for-macys?ID=7471811&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:13:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-edge-lux-clima-running-sneakers-from-finish-line?ID=6861359&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:13:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-legend-react-running-sneakers-from-finish-line?ID=7722420&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:13:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/blue-by-betsey-johnson-fifi-dress-boots?ID=7445783&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:13:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-womens-defy-casual-sneakers-from-finish-line?ID=7045278&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:13:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/fancy-feet-by-foot-petals-ball-of-foot-cushions-shoe-inserts?ID=2401843&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:13:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-infant-fluff-ballet-flats?ID=6696793&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Kids', "Kids' Shoes", '', '']
2019-04-28 12:13:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-be-light-infiknitely-athletic-walking-sneakers-from-finish-line?ID=6976803&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:13:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-swift-run-casual-sneakers-from-finish-line?ID=6653162&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:13:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/callisto-beguile-slide-studded-platform-wedge-sandals-created-for-macys?ID=6874045&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:13:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/cliffs-by-white-mountain-hilt-flats?ID=7826242&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:13:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-fresh-foam-cruz-v2-running-sneakers-from-finish-line?ID=6820486&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/asics-womens-gel-excite-4-running-sneakers-from-finish-line?ID=7006177&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-madisen-wide-calf-riding-boots?ID=6691457&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nine-west-quianiya-pumps?ID=6143160&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:08 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/mark-nason-los-angeles-womens-modern-jogger-debbie-casual-sneakers-from-finish-line?ID=6364048&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-revolution-4-running-sneakers-from-finish-line?ID=6856528&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:14:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-247-v2-casual-sneakers-from-finish-line?ID=6713246&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-flex-trainer-8-training-sneakers-from-finish-line?ID=6190452&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/franco-sarto-velma-platform-sandals?ID=8161048&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-x-90-casual-sneakers-from-finish-line?ID=6653232&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/indigo-rd.-izma-faux-fur-hiker-booties?ID=7008198&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/franco-sarto-caia-city-dress-sandals?ID=8161004&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/guess-womens-nalony-western-booties?ID=7038253&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-new-york-womens-kiera-7-sneakers?ID=7214591&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/white-mountain-remi-riding-boots-created-for-macys?ID=6865958&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dkny-jami-platform-booties-created-for-macys?ID=6779623&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:38 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/naturalizer-giselle-booties?ID=6799945&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-superstar-bts-premium-casual-sneakers-from-finish-line?ID=6936271&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:14:48 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-mk-flex-kitten-pumps?ID=9353965&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-all-star-ox-casual-sneakers-from-finish-line?ID=7884437&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:15:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/white-mountain-remi-wide-calf-riding-boots-created-for-macys?ID=6865963&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-madison-casual-sneakers-from-finish-line?ID=7006190&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:14 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/i.n.c.-fluffy-faux-fur-scuff-slippers-created-for-macys?ID=6550793&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/clarks-collection-womens-emslie-craft-booties?ID=5970517&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-fresh-foam-cruz-v2-running-sneakers-from-finish-line?ID=6820489&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-el-distrito-casual-sneakers-from-finish-line?ID=6976790&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/jessica-simpson-jazzy-embellished-dress-sandals?ID=7051044&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-gowalk-lite-walking-sneakers-from-finish-line?ID=6293847&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-hi-casual-sneakers-from-finish-line?ID=6820404&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vlado-womens-bella-casual-sneakers-from-finish-line?ID=6861382&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/white-mountain-katrina-buckle-boots?ID=7110024&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:56 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-tubular-shadow-casual-sneakers-from-finish-line?ID=4364726&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/clarks-collection-womens-annadel-molly-wedge-sandals?ID=6401941&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/franco-sarto-ginny-toe-thong-sandals?ID=8161021&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-puremotion-casual-sneakers-from-finish-line?ID=6936268&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/madden-girl-flash-slouch-boots?ID=7290520&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:15:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-benassi-just-do-it-swoosh-slide-sandals-from-finish-line?ID=6856861&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:16:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-shoreline-casual-sneakers-from-finish-line?ID=6856580&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:16:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-cleo-gradient-casual-ballet-flats-from-finish-line?ID=7262497&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:16:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nine-west-russity-booties?ID=8503870&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:16:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dkny-womens-banson-sneakers-created-for-macys?ID=9337544&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:16:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/calvin-klein-womens-jeanna-shooties?ID=6865570&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:16:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/sperry-womens-angelfish-boat-shoes?ID=9347817&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:16:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/betsey-johnson-jane-lucite-pumps?ID=9367237&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:16:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/easy-street-tess-wide-calf-buckle-boots?ID=6398362&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:16:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/naturalizer-wright-pumps?ID=4842481&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:16:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-i-5923-runner-casual-sneakers-from-finish-line?ID=6489842&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:16:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-gowalk-4-diffuse-walking-sneakers-from-finish-line?ID=6861392&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:16:52 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/rialto-cinco-embroidered-over-the-knee-boots?ID=7039612&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:16:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dkny-montreal-boots-created-for-macys?ID=7261968&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:17:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-fresh-foam-veniz-wide-width-running-sneakers-from-finish-line?ID=6653228&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:17:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-fuelcore-coast-v4-city-stealth-running-sneakers-from-finish-line?ID=7045265&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:17:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-dlites-rose-blooms-walking-sneakers-from-finish-line?ID=6976808&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:17:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vince-camuto-empiana-flat-sandals?ID=8234650&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:17:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dkny-heidi-dress-sandals-created-for-macys?ID=7262053&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:17:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/aldo-praolith-booties?ID=7176993&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:17:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-gowalk-lite-walking-sneakers-from-finish-line?ID=6293846&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:17:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/bandolino-tad-wedge-pumps?ID=2982067&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:17:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/naturalizer-geonna-flats?ID=7065146&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:17:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/naturalizer-brina-wedge-pumps?ID=7027907&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:17:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-all-star-ox-sneakers-from-finish-line?ID=2443176&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:17:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-big-eyelets-ox-casual-sneakers-from-finish-line?ID=6976784&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:18:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/naturalizer-mason-sandals?ID=5395705&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:18:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/american-rag-shannen-slip-on-sneakers-created-for-macys?ID=5062105&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:18:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-microburst-botanical-paradise-athletic-walking-sneakers-from-finish-line?ID=7262502&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:18:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/naturalizer-marianne-6-slip-on-sneakers?ID=6885193&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:18:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/keds-womens-scout-chukka-twill-booties?ID=8224293&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:18:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/clarks-collection-womens-marion-jess-clogs?ID=7277420&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:18:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-gowalk-2-frontrunner-casual-walking-sneakers-from-finish-line?ID=7109383&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:18:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-bobs-beach-bingo-kitty-concert-bobs-for-dogs-casual-sneakers-from-finish-line?ID=7006219&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:18:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-relaxed-fit-breathe-easy-fortuneknit-wide-width-casual-walking-sneakers-from-finish-line?ID=7079013&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/callisto-bossy-slide-wedge-sandals-created-for-macys?ID=6697546&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-og-97-double-up-shiny-dancer-slip-on-casual-shoes-from-finish-line?ID=4574943&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vlado-womens-nova-casual-athletic-sneakers-from-finish-line?ID=6861387&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dkny-elie-pumps-created-for-macys?ID=8053772&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-247-v2-casual-sneakers-from-finish-line?ID=6897310&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-be-light-infiknitely-athletic-walking-sneakers-from-finish-line?ID=6976805&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nautica-rudder-espadrille-flats?ID=6132875&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-bromley-riding-boots?ID=6081990&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/asics-womens-gel-venture-6-running-sneakers-from-finish-line?ID=6751021&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/baretraps-noelani-perforated-ankle-booties?ID=6095670&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ed-by-ellen-degeneres-wilesly-casual-slippers-created-for-macys?ID=8330738&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-relaxed-fit-breathe-easy-defiknit-athletic-walking-sneakers-from-finish-line?ID=6976812&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-work-relaxed-fit-felton-albie-sr-wide-work-sneakers-from-finish-line?ID=6293856&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/jbu-by-jambu-womens-granada-flats?ID=4700756&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:19:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-hampshire-boots-from-finish-line?ID=5298602&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:20:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-new-york-womens-hannon-crisscross-sandals?ID=7365568&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:20:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/bzees-flavor-flats?ID=6697761&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:20:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-fast-exp-z07-casual-sneakers-from-finish-line?ID=6713397&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:20:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-madison-casual-sneakers-from-finish-line?ID=6820405&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:20:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dr.-scholls-leader-flats?ID=5242301&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:20:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-kids-gita-boots?ID=8844071&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:20:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-ebernon-mid-casual-sneakers-from-finish-line?ID=7145514&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:20:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-summits-light-dreaming-wide-width-athletic-sneakers-from-finish-line?ID=6627786&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:20:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nanette-by-nanette-lepore-rhona-slingback-kitten-heels-created-for-macys?ID=8783167&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/bar-iii-lacy-sock-booties-created-for-macys?ID=6314035&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nine-west-jellint-stud-sandals?ID=7787261&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-all-star-seasonal-ox-casual-sneakers-from-finish-line?ID=7078993&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:10 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-my-sweet-casual-athletic-sneakers-from-finish-line?ID=7045232&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-street-poppy-blurred-lines-slip-on-casual-sneakers-from-finish-line?ID=6713091&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-gowalk-4-diffuse-walking-sneakers-from-finish-line?ID=6861391&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/mark-nason-los-angeles-womens-a-line-daze-slip-on-casual-sneakers-from-finish-line?ID=7884143&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:19 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vlado-womens-bella-slip-on-casual-sneakers-from-finish-line?ID=6861384&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/aerosoles-double-trouble-2-booties?ID=4746430&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/sorel-womens-out-n-about-plus-waterproof-boots?ID=7355471&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:28 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-street-poppy-blurred-lines-slip-on-casual-sneakers-from-finish-line?ID=6861394&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/franco-sarto-duran-pumps?ID=6651462&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-ox-casual-sneakers-from-finish-line?ID=7006191&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:41 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-x-90-casual-sneakers-from-finish-line?ID=6820490&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-be-light-my-honor-casual-walking-sneakers-from-finish-line?ID=6037548&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/giani-bernini-langleyy-memory-foam-loafers-created-for-macys?ID=7818022&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-originals-pharrell-williams-tennis-hu-casual-sneakers-from-finish-line?ID=7986932&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:43 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-d-lites-interlude-walking-sneakers-from-finish-line?ID=6190326&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:21:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-free-run-flyknit-2018-running-sneakers-from-finish-line?ID=6785014&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:22:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-edge-bounce-running-sneakers-from-finish-line?ID=6489838&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:22:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/keds-womens-double-decker-suede-sneakers?ID=9337447&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:22:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lucca-lane-jadia-block-heel-ankle-booties?ID=6834829&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:22:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/baretraps-farrell-rebound-technology-flats?ID=7649560&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:22:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-air-max-motion-racer-2-running-sneakers-from-finish-line?ID=7262582&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:22:22 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-relaxed-fit-breathe-easy-fortuneknit-wide-width-casual-walking-sneakers-from-finish-line?ID=6820464&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:22:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/franco-sarto-shelton-platform-wedge-loafers?ID=6857532&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:22:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-bobs-plush-sporty-dogs-bobs-for-dogs-casual-slip-on-flats-from-finish-line?ID=6453619&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:22:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-smart-n-sassy-athletic-walking-sneakers-from-finish-line?ID=7006239&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:22:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/asics-womens-gel-excite-4-running-sneakers-from-finish-line?ID=7006168&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:22:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-microburst-botanical-paradise-athletic-walking-sneakers-from-finish-line?ID=7262501&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:22:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-gowalk-lite-walking-sneakers-from-finish-line?ID=6293843&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:22:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-pureboost-dpr-running-sneakers-from-finish-line?ID=6976774&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:23:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/michael-michael-kors-alba-flex-kitten-heel-pumps?ID=6955330&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:23:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-x-90-casual-sneakers-from-finish-line?ID=6656967&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:23:34 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-gowalk-joy-casual-walking-sneakers-from-finish-line?ID=6856637&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:23:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/muk-luks-womens-amira-ankle-boot-slippers?ID=5341300&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:23:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-relaxed-fit-breathe-easy-quiet-tude-athletic-walking-sneakers-from-finish-line?ID=6976814&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-dlites-rose-blooms-walking-sneakers-from-finish-line?ID=6976809&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:03 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-superstar-casual-sneakers-from-finish-line?ID=3524084&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:24:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-new-york-womens-kalvin-high-top-slip-on-sneakers?ID=2722904&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/aerosoles-getaway-pumps?ID=7045521&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:16 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/circus-by-sam-edelman-columbia-espadrille-flatforms?ID=8447406&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/dkny-jadyn-sneakers-created-for-macys?ID=5832633&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/asics-womens-gel-excite-4-running-sneakers-from-finish-line?ID=7006169&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/ugg-infant-i-erin-booties?ID=4342210&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 199, in gather_macys_variation
    category, weight, profit_margin_rate, estimated_shipping_cost_in_usd, estimated_profit_in_usd, final_price_in_usd, final_price_in_npr = self.map_and_calculate(store='Macys', category_list=category_list, original_price_in_usd=original_price_in_usd)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 374, in map_and_calculate
    raise Exception("Could not find a qarece mapping in category mapping file for %s store's category hierarchy %s" % (store, padded_category_list))
Exception: Could not find a qarece mapping in category mapping file for Macys store's category hierarchy ['Kids', "Kids' Shoes", '', '']
2019-04-28 12:24:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-big-eyelets-high-top-casual-sneakers-from-finish-line?ID=6897184&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/seven-dials-norbury-block-heel-dress-boots?ID=6843913&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/aerosoles-tall-tale-pumps?ID=7045547&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:39 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vlado-womens-bella-casual-sneakers-from-finish-line?ID=6861371&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:42 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-purebounce-running-sneakers-from-finish-line?ID=6861361&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:44 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/thalia-sodi-beckie-over-the-knee-boots-created-for-macys?ID=6331117&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/white-mountain-davenport-ankle-booties?ID=6725488&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:57 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-bobs-beach-bingo-kitty-concert-bobs-for-dogs-casual-sneakers-from-finish-line?ID=7006218&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:24:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-edge-lux-clima-running-sneakers-from-finish-line?ID=6936260&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:25:00 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/callisto-shana-embellished-thong-wedge-sandals?ID=1954066&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:25:11 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-swift-run-casual-sneakers-from-finish-line?ID=5958583&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:25:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/bcbgeneration-ilsie-two-piece-sandals?ID=7277343&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:25:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-summits-quick-getaway-wide-width-walking-sneakers-from-finish-line?ID=6861396&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:25:25 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-air-max-axis-casual-sneakers-from-finish-line?ID=6861442&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:25:27 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-fresh-foam-cruz-v2-decon-running-sneakers-from-finish-line?ID=7336875&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:25:35 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-d-lites-life-saver-wide-walking-sneakers-from-finish-line?ID=6856642&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:25:46 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-gratis-full-circle-bungee-casual-sneakers-from-finish-line?ID=2464303&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:25:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/seven-dials-felicia-glitter-booties?ID=7598410&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:25:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/i.n.c.-womens-reesie-rhinestone-bow-evening-sandals-created-for-macys?ID=2792037&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:04 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/rialto-madeline-pumps?ID=9027100&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:13 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/lauren-ralph-lauren-madisen-riding-boots?ID=6331569&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:15 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/mark-nason-los-angeles-womens-block-varsity-athletic-sneakers-from-finish-line?ID=7986945&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:18 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-be-light-infiknitely-athletic-walking-sneakers-from-finish-line?ID=6976804&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/bandolino-gillmiro-strappy-wedge-sandals?ID=6639690&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/mark-nason-los-angeles-womens-block-varsity-athletic-sneakers-from-finish-line?ID=7986944&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/white-mountain-ever-two-piece-block-heel-sandals-created-for-macys?ID=6576519&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/thalia-sodi-verrda2-embellished-platform-dress-sandals-created-for-macys?ID=7891651&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/mark-nason-los-angeles-womens-block-varsity-athletic-sneakers-from-finish-line?ID=7986943&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-fuelcore-coast-v4-city-stealth-running-sneakers-from-finish-line?ID=7045264&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:50 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/jessica-simpson-lyndy-slouchy-boots?ID=6904806&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/charter-club-boniee-ankle-booties-created-for-macys?ID=6314130&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nike-womens-air-max-1-se-running-sneakers-from-finish-line?ID=8505643&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:53 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/naturalizer-tamara-flats?ID=7065156&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:55 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/isotoner-signature-womens-signature-velour-clog-slippers-with-memory-foam?ID=8177670&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:26:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-4-you-define-casual-walking-sneakers-from-finish-line-from-finish-line?ID=5216491&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:27:02 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/keds-for-kate-spade-new-york-kickstart-dancing-dot-sneakers?ID=6160573&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:27:05 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/steve-madden-wanda-faux-fur-wedge-sneakers?ID=7261593&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:27:07 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/aerosoles-exit-ramp-slingback-dress-sandals?ID=6905047&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:27:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nine-west-russity-booties?ID=7001621&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:27:20 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vlado-womens-bella-casual-sneakers-from-finish-line?ID=6861383&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:27:30 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/zigi-soho-heide-dress-boots?ID=7045886&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:27:31 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-hi-casual-sneakers-from-finish-line?ID=6976785&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:27:33 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/converse-womens-chuck-taylor-hi-casual-sneakers-from-finish-line?ID=2443175&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 108, in parse_macys
    loaders.append(self.gather_macys_variation(sku_obj=product, parent_details=shared_product_details, category_list=macys_category_list, is_parent=True, is_variable=is_variable_product))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 153, in gather_macys_variation
    selected_color = str(parent_details['attributes']['colors']['selectedColor'])
KeyError: 'selectedColor'
2019-04-28 12:27:36 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-graceful-twisted-fortune-walking-sneakers-from-finish-line?ID=6784736&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:27:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/reebok-womens-freestyle-high-top-casual-sneakers-from-finish-line?ID=6294053&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:27:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vlado-womens-bella-casual-sneakers-from-finish-line?ID=6861381&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:27:58 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/g-by-guess-ariella-slippers?ID=7951630&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:28:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/tommy-hilfiger-ilia-wide-calf-riding-boots-created-for-macys?ID=6873700&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:28:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-fresh-foam-cruz-v2-running-sneakers-from-finish-line?ID=6820487&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:28:17 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-tubular-invader-strap-casual-sneakers-from-finish-line?ID=4672504&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:28:21 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/style-co-hayley-wide-calf-over-the-knee-zip-boots-created-for-macys?ID=6324554&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:28:37 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-relaxed-fit-breathe-easy-thankful-walking-sneakers-from-finish-line?ID=6221679&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:28:49 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/nine-west-anikol-buckle-flats?ID=7787233&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:28:51 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/vlado-womens-bella-slip-on-casual-sneakers-from-finish-line?ID=6861385&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:28:54 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/i.n.c.-womens-layloni-stretch-two-piece-kitten-heel-pumps-created-for-macys?ID=7364528&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:29:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/katy-perry-unity-peep-toe-booties?ID=5056169&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:29:09 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/indigo-rd.-salem-perforated-booties?ID=7059532&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:29:12 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/adidas-womens-edge-bounce-running-sneakers-from-finish-line?ID=6861358&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:29:23 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/teva-womens-ember-moccasin-slippers?ID=6277082&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:29:24 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/skechers-womens-relaxed-fit-bikers-casual-booties-from-finish-line?ID=6152839&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:29:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/giani-bernini-valina-memory-foam-oxfords-created-for-macys?ID=6314418&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:29:26 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/marc-fisher-viviene-block-heel-pumps?ID=8483158&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:29:40 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/gentle-souls-by-kenneth-cole-womens-best-of-moto-boots?ID=6748193&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:29:45 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/new-balance-womens-574-rose-gold-casual-sneakers-from-finish-line?ID=7006260&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:29:47 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/puma-womens-vikky-casual-sneakers-from-finish-line?ID=6861462&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:29:59 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/kenneth-cole-reaction-great-gal-wedge-sandals?ID=9354026&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:30:01 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/aldo-gwayviel-dress-sandals?ID=8031431&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
2019-04-28 12:30:06 [scrapy.core.scraper] ERROR: Spider error processing <GET https://www.macys.com/shop/product/mark-nason-los-angeles-womens-a-line-rider-casual-sneakers-from-finish-line?ID=6820436&CategoryID=56233> (referer: None)
Traceback (most recent call last):
  File "/anaconda3/lib/python3.6/site-packages/scrapy/utils/defer.py", line 102, in iter_errback
    yield next(it)
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/offsite.py", line 29, in process_spider_output
    for x in result:
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/middlewares.py", line 35, in process_spider_output
    for i in result:
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/referer.py", line 339, in <genexpr>
    return (_set_referer(r) for r in result or ())
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/urllength.py", line 37, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/anaconda3/lib/python3.6/site-packages/scrapy/spidermiddlewares/depth.py", line 58, in <genexpr>
    return (r for r in result or () if _filter(r))
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/spiders/products.py", line 16, in parse
    loaders = self.productItemLoader.parse_macys(product_url=request_url, html_dump=response)
  File "/Users/sujilmaharjan/Desktop/qarece-web-crawler/product_scraper/product_scraper/itemloaders.py", line 87, in parse_macys
    upcs_list = dict(product['relationships']['memberProductMap']).keys()
KeyError: 'memberProductMap'
